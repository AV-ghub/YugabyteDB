–û—Ç–ª–∏—á–Ω–æ! –ö–æ–º–∞–Ω–¥–∞ `dnf module list postgresql` –ø–æ–∫–∞–∑–∞–ª–∞, —á—Ç–æ –º–æ–¥—É–ª—å PostgreSQL –≤ —Å–∏—Å—Ç–µ–º–µ –µ—Å—Ç—å, –Ω–æ **–Ω–µ –≤—ã–±—Ä–∞–Ω –ø–æ—Ç–æ–∫ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è –≤–µ—Ä—Å–∏–∏ 15** (—É –≤–µ—Ä—Å–∏–∏ 10 —Å—Ç–æ–∏—Ç `[d]`, –∞ —É 15 ‚Äî –Ω–µ—Ç). –≠—Ç–æ —Ö–æ—Ä–æ—à–æ.

**–ù–æ –≤—Ç–æ—Ä–∞—è –∫–æ–º–∞–Ω–¥–∞ –≤—ã–∑—ã–≤–∞–µ—Ç –≤–æ–ø—Ä–æ—Å—ã:** `dnf install -y postgis33_15 --allowerasing --skip-broken` –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å –≤—ã–≤–æ–¥–æ–º `Nothing to do. Complete!`. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ DNF **–Ω–µ –Ω–∞—à—ë–ª** –ø–∞–∫–µ—Ç `postgis33_15` –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤ —Ç–µ–∫—É—â–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏. –í–æ–∑–º–æ–∂–Ω–æ, –ø—Ä–µ–¥—ã–¥—É—â–∞—è –ø–æ–ø—ã—Ç–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ (–∫–æ—Ç–æ—Ä–∞—è –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å –æ—à–∏–±–∫–æ–π) –æ—Å—Ç–∞–≤–∏–ª–∞ –ø–∞–∫–µ—Ç –≤ –∫–∞–∫–æ–º-—Ç–æ —Å–æ—Å—Ç–æ—è–Ω–∏–∏, –∏–ª–∏ –µ—Å—Ç—å –¥—Ä—É–≥–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è–º–∏.

–ü—Ä–µ–∂–¥–µ —á–µ–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å, –Ω—É–∂–Ω–æ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ PostGIS **–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω** –∏ –µ–≥–æ —Ñ–∞–π–ª—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã –≤ –Ω—É–∂–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ YugabyteDB.

### üîç –®–∞–≥ 1. –ü—Ä–æ–≤–µ—Ä–∏–º, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ª–∏ –ø–∞–∫–µ—Ç PostGIS
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ª–∏ –ø–∞–∫–µ—Ç postgis33_15
rpm -qa | grep postgis

# –ï—Å–ª–∏ –ø–∞–∫–µ—Ç–∞ –Ω–µ—Ç, –ø–æ–ø—Ä–æ–±—É–µ–º —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –µ–≥–æ —è–≤–Ω–æ, –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏–≤ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å
dnf list available postgis33_15

# –ï—Å–ª–∏ –ø–∞–∫–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –µ–≥–æ —Å —Ñ–ª–∞–≥–æ–º, –∏–≥–Ω–æ—Ä–∏—Ä—É—é—â–∏–º –º–æ–¥—É–ª—å–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã
dnf install -y postgis33_15 --nodocs --setopt=module_platform_id=platform:el8
```
–ï—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ —É–¥–∞–ª–∞—Å—å, –≤–æ–∑–º–æ–∂–Ω–æ, –Ω—É–∂–Ω–æ —Å–±—Ä–æ—Å–∏—Ç—å –∏–ª–∏ –æ—Ç–∫–ª—é—á–∏—Ç—å –º–æ–¥—É–ª—å —è–≤–Ω–æ –¥–ª—è –ø–æ—Ç–æ–∫–∞ 15.

### üóÇÔ∏è –®–∞–≥ 2. –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ PostGIS (–µ—Å–ª–∏ –ø–∞–∫–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
–ï—Å–ª–∏ –ø–∞–∫–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∏–ª—Å—è, —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª—ã –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ YugabyteDB:
```bash
# –ö–æ–ø–∏—Ä—É–µ–º —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
cp -r /usr/pgsql-15/share/extension/*postgis* /home/yugabyte/share/postgresql/extension/

# –ö–æ–ø–∏—Ä—É–µ–º contrib-—Å–∫—Ä–∏–ø—Ç—ã (–≤–µ—Ä—Å–∏—è –º–æ–∂–µ—Ç –±—ã—Ç—å 3.3)
cp -r /usr/pgsql-15/share/contrib/postgis-3.3 /home/yugabyte/share/postgresql/contrib/

# –ö–æ–ø–∏—Ä—É–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫—É
cp /usr/pgsql-15/lib/postgis-3.3.so /home/yugabyte/lib/postgresql/

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —Ñ–∞–π–ª—ã –Ω–∞ –º–µ—Å—Ç–µ
ls -la /home/yugabyte/share/postgresql/extension/ | grep -i postgis
```

### üß™ –®–∞–≥ 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—ã PostGIS –≤ YugabyteDB
–ü–æ—Å–ª–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤ –≤—ã–π–¥–∏—Ç–µ –∏–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (`exit`) –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –µ–≥–æ:
```bash
docker-compose restart yb-tserver-a
sleep 30  # –ñ–¥–µ–º –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞
```
–¢–µ–ø–µ—Ä—å –ø–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ –∫–ª–∞—Å—Ç–µ—Ä—É –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ:
```bash
psql -h localhost -p 5433 -U yugabyte -d geo_test << 'EOF'
-- 1. –ü—Ä–æ–±—É–µ–º —Å–æ–∑–¥–∞—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ (—ç—Ç–æ –≥–ª–∞–≤–Ω—ã–π —Ç–µ—Å—Ç!)
CREATE EXTENSION postgis;

-- 2. –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–µ—Ä—Å–∏—é
SELECT postgis_version();

-- 3. –ü—Ä–æ—Å—Ç–µ–π—à–∏–π –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–π –∑–∞–ø—Ä–æ—Å
SELECT ST_MakePoint(37.6178, 55.7558) AS moscow_point,
       ST_GeomFromText('POLYGON((0 0, 1 0, 1 1, 0 1, 0 0))') AS square;

-- 4. –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω—ã–µ –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
\dfS *geometry*
EOF
```

### üìä –í–æ–∑–º–æ–∂–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ —Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

| –†–µ–∑—É–ª—å—Ç–∞—Ç —Ç–µ—Å—Ç–∞ | –ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç | –î–∞–ª—å–Ω–µ–π—à–∏–µ –¥–µ–π—Å—Ç–≤–∏—è |
|----------------|--------------|----------------------|
| **`CREATE EXTENSION` —É—Å–ø–µ—à–Ω–æ** | PostGIS —Ä–∞–±–æ—Ç–∞–µ—Ç! | –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–º –≥–µ–æ-–∑–∞–ø—Ä–æ—Å–∞–º. |
| **–û—à–∏–±–∫–∞: —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω** (`postgis.control` –∏ —Ç.–ø.) | –§–∞–π–ª—ã –Ω–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–ª–∏—Å—å –∏–ª–∏ –ª–µ–∂–∞—Ç –Ω–µ —Ç–∞–º. | –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —à–∞–≥ 2, –ø—É—Ç–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è. |
| **–û—à–∏–±–∫–∞: —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–æ** | –ü–∞–∫–µ—Ç –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏–ª–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç –º–æ–¥—É–ª–µ–π –Ω–µ —Ä–µ—à–µ–Ω. | –í–µ—Ä–Ω–∏—Ç–µ—Å—å –∫ —à–∞–≥—É 1, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–∞–∫–µ—Ç–∞. |

### üí° –ï—Å–ª–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –Ω–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è: —É–≥–ª—É–±–ª—ë–Ω–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
–ï—Å–ª–∏ `CREATE EXTENSION postgis;` –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª, –ø–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
```bash
# –í–æ–π–¥–∏—Ç–µ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å–Ω–æ–≤–∞
docker exec -it yugabyte_yb-tserver-a_1 bash

# –°—Ç–∞–Ω—å—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º yugabyte –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
su - yugabyte
find /home/yugabyte -name "postgis.control" 2>/dev/null
# –î–æ–ª–∂–µ–Ω –Ω–∞–π—Ç–∏—Å—å –ø—É—Ç—å: /home/yugabyte/share/postgresql/extension/postgis.control
```

**–ù–∞—á–Ω–∏—Ç–µ —Å –ø—Ä–æ–≤–µ—Ä–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–∞–∫–µ—Ç–∞ (`rpm -qa | grep postgis`) –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —à–∞–≥–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–æ–∑–¥–∞—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∏ —Å–æ–æ–±—â–∏—Ç–µ –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ.**
