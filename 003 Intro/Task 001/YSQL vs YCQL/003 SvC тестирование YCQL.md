–î–ª—è YCQL –Ω–∞–≥—Ä—É–∑–æ—á–Ω—ã–π —Ç–µ—Å—Ç –±—É–¥–µ—Ç –¥—Ä—É–≥–∏–º, —Ç–∞–∫ –∫–∞–∫ –∑–¥–µ—Å—å –º–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö –∏ —Å–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã ‚Äî –≤ –±—ã—Å—Ç—Ä—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö –ø–æ –∫–ª—é—á—É –∏ —Ä–∞–±–æ—Ç–µ —Å –ø–æ–ª—É—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏. –Ø –ø–æ–¥–≥–æ—Ç–æ–≤–∏–ª –Ω–∞–±–æ—Ä –∑–∞–ø—Ä–æ—Å–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—Ç –∫–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ YCQL, –∏ —Å—Ü–µ–Ω–∞—Ä–∏–π –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞, –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π –≤–∞—à–µ–º—É YSQL-—Ç–µ—Å—Ç—É, –Ω–æ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥ —Ñ–∏–ª–æ—Å–æ—Ñ–∏—é Cassandra-–ø–æ–¥–æ–±–Ω—ã—Ö –±–∞–∑.

### üìä –ù–∞–±–æ—Ä –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è YCQL

–í—ã–ø–æ–ª–Ω–∏—Ç–µ —ç—Ç–∏ –∑–∞–ø—Ä–æ—Å—ã –≤ `ycqlsh` –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª—é—Å–ø–µ–π—Å–∞ `demo` (`CREATE KEYSPACE IF NOT EXISTS demo WITH REPLICATION = {'class': 'SimpleStrategy', 'replication_factor': 3};`).

```sql
-- 1. –°–û–°–¢–ê–í–ù–û–ô –ü–ï–†–í–ò–ß–ù–´–ô –ö–õ–Æ–ß –∏ CLUSTERING ORDER (–æ—Å–Ω–æ–≤–∞ –º–æ–¥–µ–ª–∏ YCQL)
-- –°–æ–∑–¥–∞–¥–∏–º —Ç–∞–±–ª–∏—Ü—É –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π, –≥–¥–µ –¥–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
CREATE TABLE IF NOT EXISTS demo.device_telemetry (
    device_id text,
    event_time timestamp,
    sensor_id int,
    readings map<text, double>, -- –î–æ–∫—É–º–µ–Ω—Ç–Ω–∞—è –º–æ–¥–µ–ª—å –≤–Ω—É—Ç—Ä–∏ –∫–æ–ª–æ–Ω–∫–∏
    PRIMARY KEY ((device_id), event_time, sensor_id) -- device_id - –∫–ª—é—á –ø–∞—Ä—Ç–∏—Ü–∏–∏, –æ—Å—Ç–∞–ª—å–Ω–æ–µ - –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
) WITH CLUSTERING ORDER BY (event_time DESC, sensor_id ASC);

-- 2. –í–°–¢–ê–í–ö–ê –¥–∞–Ω–Ω—ã—Ö —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∫–æ–ª–ª–µ–∫—Ü–∏–π (MAP)
INSERT INTO demo.device_telemetry (device_id, event_time, sensor_id, readings)
VALUES ('device_001', toTimestamp(now()), 1, {'temperature': 23.5, 'voltage': 3.7});

-- 3. –í–´–ë–û–†–ö–ê –ø–æ –ü–ê–†–¢–ò–¶–ò–û–ù–ù–û–ú–£ –ö–õ–Æ–ß–£ (—Å–∞–º–∞—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è)
-- –ü–æ–ª—É—á–∏–º –≤—Å–µ —Å–æ–±—ã—Ç–∏—è –¥–ª—è device_001, –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ (–æ—Ç –Ω–æ–≤—ã—Ö –∫ —Å—Ç–∞—Ä—ã–º, –∏–∑-–∑–∞ CLUSTERING ORDER)
SELECT * FROM demo.device_telemetry WHERE device_id = 'device_001';

-- 4. –í–´–ë–û–†–ö–ê —Å –§–ò–õ–¨–¢–†–ê–¶–ò–ï–ô –ø–æ CLUSTERING COLUMN (—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∏–∑-–∑–∞ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏)
-- –ü–æ–ª—É—á–∏–º —Å–æ–±—ã—Ç–∏—è device_001 –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å
SELECT * FROM demo.device_telemetry WHERE device_id = 'device_001' AND event_time > '2024-01-01 10:00:00-0000';

-- 5. –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–ï –í–°–¢–†–û–ï–ù–ù–´–• –§–£–ù–ö–¶–ò–ô –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ UUID
-- TTL (Time-To-Live) - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö
CREATE TABLE demo.user_sessions (
    user_id text,
    session_id timeuuid,
    data text,
    PRIMARY KEY (user_id, session_id)
) WITH default_time_to_live = 3600; -- –î–∞–Ω–Ω—ã–µ —É–¥–∞–ª—è—Ç—Å—è —á–µ—Ä–µ–∑ —á–∞—Å
INSERT INTO demo.user_sessions (user_id, session_id, data) VALUES ('user1', now(), 'active');

-- 6. BATCH-–û–ü–ï–†–ê–¶–ò–Ø: –∞—Ç–æ–º–∞—Ä–Ω–∞—è –∑–∞–ø–∏—Å—å –≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫ –û–î–ù–û–ô –ø–∞—Ä—Ç–∏—Ü–∏–∏
-- –≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç—å –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø–∞—Ä—Ç–∏—Ü–∏–∏ (–æ—Ç–ª–∏—á–∏—Ç–µ–ª—å–Ω–∞—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å YCQL)
BEGIN BATCH
    INSERT INTO demo.device_telemetry (device_id, event_time, sensor_id, readings) VALUES ('device_001', toTimestamp(now()), 2, {'status': 1});
    INSERT INTO demo.device_telemetry (device_id, event_time, sensor_id, readings) VALUES ('device_001', toTimestamp(now()), 3, {'status': 0});
APPLY BATCH;

-- 7. –ò–ù–î–ï–ö–°–ò–†–û–í–ê–ù–ò–ï –ø–æ –ù–ï–ö–õ–Æ–ß–ï–í–û–ú–£ –ü–û–õ–Æ (–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ, –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–æ—Ä–æ–≥–∏–º)
CREATE INDEX IF NOT EXISTS ON demo.device_telemetry (sensor_id);
-- –ü–æ–∏—Å–∫ –ø–æ sensor_id —Ç–µ–ø–µ—Ä—å –≤–æ–∑–º–æ–∂–µ–Ω, –Ω–æ —Å–∫–∞–Ω–∏—Ä—É–µ—Ç –≤—Å—é —Ç–∞–±–ª–∏—Ü—É
SELECT * FROM demo.device_telemetry WHERE sensor_id = 1 LIMIT 5;

-- 8. –ú–ê–¢–ï–†–ò–ê–õ–ò–ó–û–í–ê–ù–ù–´–ï –ü–†–ï–î–°–¢–ê–í–õ–ï–ù–ò–Ø (–¥–µ–Ω–æ–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏ —á—Ç–µ–Ω–∏—è)
-- –°–æ–∑–¥–∞–¥–∏–º "–ø–µ—Ä–µ–≤–µ—Ä–Ω—É—Ç—É—é" —Ç–∞–±–ª–∏—Ü—É –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –ø–æ sensor_id
CREATE MATERIALIZED VIEW demo.sensor_to_device AS
    SELECT sensor_id, device_id, event_time, readings
    FROM demo.device_telemetry
    WHERE sensor_id IS NOT NULL AND device_id IS NOT NULL AND event_time IS NOT NULL
    PRIMARY KEY ((sensor_id), device_id, event_time); -- –¢–µ–ø–µ—Ä—å sensor_id - –∫–ª—é—á –ø–∞—Ä—Ç–∏—Ü–∏–∏
-- –ó–∞–ø—Ä–æ—Å –∫ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—é –±—É–¥–µ—Ç –±—ã—Å—Ç—Ä—ã–º
SELECT * FROM demo.sensor_to_device WHERE sensor_id = 1;
```

### ‚ö° –ù–∞–≥—Ä—É–∑–æ—á–Ω—ã–π —Ç–µ—Å—Ç –¥–ª—è YCQL (–∞–Ω–∞–ª–æ–≥ –≤–∞—à–µ–≥–æ YSQL-—Ç–µ—Å—Ç–∞)

–≠—Ç–æ—Ç —Ç–µ—Å—Ç —Å–æ–∑–¥–∞–µ—Ç –±–æ–ª—å—à–æ–π –æ–±—ä–µ–º –¥–∞–Ω–Ω—ã—Ö –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–∫–æ—Ä–æ—Å—Ç—å **—Ç–æ—á–µ—á–Ω—ã—Ö —á—Ç–µ–Ω–∏–π –∏ –∑–∞–ø–∏—Å–µ–π –ø–æ –∫–ª—é—á—É** ‚Äî —Ç–æ, –¥–ª—è —á–µ–≥–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω YCQL.

```sql
-- 1. –°–æ–∑–¥–∞–µ–º —Ç–∞–±–ª–∏—Ü—É –¥–ª—è –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞
CREATE KEYSPACE IF NOT EXISTS stress WITH REPLICATION = {'class': 'SimpleStrategy', 'replication_factor': 3};
USE stress;

DROP TABLE IF EXISTS ycql_perf_test;
CREATE TABLE ycql_perf_test (
    bucket int,          -- "–í–µ–¥—Ä–æ" –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö (–∞–Ω–∞–ª–æ–≥ –ø–∞—Ä—Ç–∏—Ü–∏–∏)
    item_id text,        -- –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ –≤–µ–¥—Ä–µ
    value double,
    payload text,
    PRIMARY KEY ((bucket, item_id)) -- –ö–ª—é—á –ø–∞—Ä—Ç–∏—Ü–∏–∏ = bucket + item_id
);

-- 2. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º 1,000,000 –∑–∞–ø–∏—Å–µ–π (—ç—Ç–æ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –ø–∞—Ä—É –º–∏–Ω—É—Ç)
--    –ò—Å–ø–æ–ª—å–∑—É–µ–º 1000 "–≤–µ–¥–µ—Ä" (bucket) –¥–ª—è —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ —É–∑–ª–∞–º
INSERT INTO stress.ycql_perf_test (bucket, item_id, value, payload)
VALUES (1, 'item_1', 0.5, 'Lorem ipsum dolor sit amet'); -- –ü–µ—Ä–≤–∞—è –∑–∞–ø–∏—Å—å

-- –î–ª—è –º–∞—Å—Å–æ–≤–æ–π –≤—Å—Ç–∞–≤–∫–∏ –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä–∞–π–≤–µ—Ä. –í ycqlsh –º–æ–∂–Ω–æ —ç–º—É–ª–∏—Ä–æ–≤–∞—Ç—å —Ü–∏–∫–ª–æ–º:
-- –í–ê–ñ–ù–û: –í —Ä–µ–∞–ª—å–Ω–æ–º —Ç–µ—Å—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ yugabyted load –∏–ª–∏ —Å–≤–æ–π —Å–∫—Ä–∏–ø—Ç. –≠—Ç–æ –¥–ª—è –¥–µ–º–æ:
BEGIN BATCH
INSERT INTO ycql_perf_test (bucket, item_id, value, payload) VALUES (1, 'item_1', 0.5, 'payload1');
INSERT INTO ycql_perf_test (bucket, item_id, value, payload) VALUES (1, 'item_2', 1.5, 'payload2');
APPLY BATCH;

-- 3. –¢–ï–°–¢ 1: –ú–æ–ª–Ω–∏–µ–Ω–æ—Å–Ω–æ–µ —Ç–æ—á–µ—á–Ω–æ–µ —á—Ç–µ–Ω–∏–µ –ø–æ –∫–ª—é—á—É (—Å–∏–ª—å–Ω–∞—è —Å—Ç–æ—Ä–æ–Ω–∞ YCQL)
-- –í–∫–ª—é—á–∏–º —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫—É, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
TRACING ON;
SELECT * FROM ycql_perf_test WHERE bucket = 100 AND item_id = 'item_500';
TRACING OFF;

-- 4. –¢–ï–°–¢ 2: –ó–∞–ø–∏—Å—å/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ –∫–ª—é—á—É
TRACING ON;
UPDATE ycql_perf_test SET value = 99.9 WHERE bucket = 100 AND item_id = 'item_500';
TRACING OFF;

-- 5. –¢–ï–°–¢ 3: –ß—Ç–µ–Ω–∏–µ –í–°–ï–• –∑–∞–ø–∏—Å–µ–π –∏–∑ –æ–¥–Ω–æ–π –ø–∞—Ä—Ç–∏—Ü–∏–∏ (—Ç–∞–∫–∂–µ –±—ã—Å—Ç—Ä–æ)
-- –ü–æ–ª—É—á–∏–º –≤—Å–µ item_id –¥–ª—è bucket=100 (–ª–∏–º–∏—Ç 1000 –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)
SELECT item_id, value FROM ycql_perf_test WHERE bucket = 100 LIMIT 1000;

-- 6. –¢–ï–°–¢ 4 (–ü–æ–∫–∞–∑–∞—Ç–µ–ª—å–Ω—ã–π): –ü–æ–ø—ã—Ç–∫–∞ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –ë–ï–ó –∫–ª—é—á–∞ –ø–∞—Ä—Ç–∏—Ü–∏–∏ - –±—É–¥–µ—Ç –ú–ï–î–õ–ï–ù–ù–û
-- –≠—Ç–∏–º –º—ã –ø–æ–∫–∞–∂–µ–º —Ä–∞–∑–Ω–∏—Ü—É —Å YSQL. YCQL –Ω–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è.
-- –í–∫–ª—é—á–∏–º —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫—É –∏ —É–≤–∏–¥–∏–º, —á—Ç–æ –∑–∞–ø—Ä–æ—Å –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –¥–æ–ª–≥–æ –∏–ª–∏ —Å —Ç–∞–π–º–∞—É—Ç–æ–º.
TRACING ON;
SELECT bucket, COUNT(*) FROM ycql_perf_test GROUP BY bucket LIMIT 5;
TRACING OFF;
```

### üìà –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∏ –æ—Ç–ª–∏—á–∏–µ –æ—Ç YSQL

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞ –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ –≤—ã–≤–æ–¥ `TRACING ON`. –í—ã —É–≤–∏–¥–∏—Ç–µ:
*   **–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è** –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ (–æ–±—ã—á–Ω–æ **–º–µ–Ω–µ–µ 10 –º—Å** –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π –ø–æ –∫–ª—é—á—É).
*   **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º—ã—Ö —Å—Ç—Ä–æ–∫** (`rows fetched from storage`).

**–ö–ª—é—á–µ–≤–æ–µ –æ—Ç–ª–∏—á–∏–µ –æ—Ç –≤–∞—à–µ–≥–æ YSQL-—Ç–µ—Å—Ç–∞:**
*   **YSQL** –±–ª–µ—Å—Ç—è—â–µ —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å –∞–≥—Ä–µ–≥–∞—Ü–∏—è–º–∏ –ø–æ –≤—Å–µ–π —Ç–∞–±–ª–∏—Ü–µ (`GROUP BY category`), —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å, –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.
*   **YCQL** –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é —Å–∫–æ—Ä–æ—Å—Ç—å –Ω–∞ **—Ç–æ—á–µ—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö –ø–æ –∏–∑–≤–µ—Å—Ç–Ω–æ–º—É –∫–ª—é—á—É** (`WHERE bucket=... AND item_id=...`), –Ω–æ **–Ω–µ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –ø–æ–ª–Ω–æ—Ç–∞–±–ª–∏—á–Ω—ã—Ö –∞–≥—Ä–µ–≥–∞—Ü–∏–π** (–ø–æ—Å–ª–µ–¥–Ω–∏–π —Ç–µ—Å—Ç —ç—Ç–æ –Ω–∞–≥–ª—è–¥–Ω–æ –ø–æ–∫–∞–∂–µ—Ç). –¢–∞–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã –≤ YCQL –±—É–¥—É—Ç –º–µ–¥–ª–µ–Ω–Ω—ã–º–∏, —Ç–∞–∫ –∫–∞–∫ —Ç—Ä–µ–±—É—é—Ç –ø–æ–ª–Ω–æ–≥–æ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Å–µ—Ö —É–∑–ª–æ–≤ –∫–ª–∞—Å—Ç–µ—Ä–∞.

**–ö–∞–∫–æ–π –≤—ã–≤–æ–¥ —Å–¥–µ–ª–∞—Ç—å –∑–∞ 2 —á–∞—Å–∞?** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ YCQL, –∫–æ–≥–¥–∞ –≤–∞—à –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º –≤ 90% —Å–ª—É—á–∞–µ–≤ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ **–∏–∑–≤–µ—Å—Ç–Ω–æ–º—É –∫–ª—é—á—É** (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–ª—É—á–∏—Ç—å –∑–∞–∫–∞–∑ –ø–æ ID, —Å–µ—Å—Å–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –ø–æ–∫–∞–∑–∞–Ω–∏—è –¥–∞—Ç—á–∏–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞). –ï—Å–ª–∏ –∂–µ –Ω—É–∂–Ω—ã —Å–ª–æ–∂–Ω—ã–µ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã, –¥–∂–æ–π–Ω—ã –∏ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –ø–æ —Ä–∞–∑–Ω—ã–º –ø–æ–ª—è–º ‚Äî —ç—Ç–æ —Å—Ñ–µ—Ä–∞ YSQL.

–î–ª—è –±–æ–ª–µ–µ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–≥–æ –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞ —Å –º–∏–ª–ª–∏–æ–Ω–æ–º –∑–∞–ø–∏—Å–µ–π –ª—É—á—à–µ –Ω–∞–ø–∏—Å–∞—Ç—å –Ω–µ–±–æ–ª—å—à–æ–π —Å–∫—Ä–∏–ø—Ç –Ω–∞ Python —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –¥—Ä–∞–π–≤–µ—Ä–∞ `cassandra-driver`, –Ω–æ –¥–ª—è –æ–∑–Ω–∞–∫–æ–º–∏—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–ª–µ–π –∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ —Ñ–∏–ª–æ—Å–æ—Ñ–∏–∏ YCQL –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω–æ–≥–æ –≤—ã—à–µ —Å—Ü–µ–Ω–∞—Ä–∏—è –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ. –£—Å–ø–µ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è!


---------------------------------------------


–û—Ç–ª–∏—á–Ω–æ, –º—ã –¥–æ–∫–æ–ø–∞–ª–∏—Å—å –¥–æ –∫–ª—é—á–µ–≤–æ–π –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏! –û—à–∏–±–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å `BEGIN TRANSACTION BATCH` –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é –≤ `ycqlsh`. –í YugabyteDB YCQL —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø–∞—Ä—Ç–∏—Ü–∏–∏ —Ä–µ–∞–ª–∏–∑—É—é—Ç—Å—è **—Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ prepared statements –∏ –¥—Ä–∞–π–≤–µ—Ä –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è** (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–∞ Java, Python), –∞ –Ω–µ —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π `ycqlsh`.

–≠—Ç–æ –≤–∞–∂–Ω–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É "–∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–º CQL" –∏ –µ–≥–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π –≤ YugabyteDB. –î–∞–≤–∞–π—Ç–µ –æ–±–æ–π–¥–µ–º —ç—Ç–æ –∏ –ø—Ä–æ–¥–æ–ª–∂–∏–º –∏–∑—É—á–µ–Ω–∏–µ –¥—Ä—É–≥–∏–º–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å–Ω—ã–º–∏ —Ç–µ—Å—Ç–∞–º–∏, –∫–æ—Ç–æ—Ä—ã–µ —Ç–æ—á–Ω–æ —Å—Ä–∞–±–æ—Ç–∞—é—Ç –≤ CLI.

### üéØ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ –∏ —Ä–∞–±–æ—á–∏–µ —Ç–µ—Å—Ç—ã –¥–ª—è ycqlsh

–ü–æ—Å–∫–æ–ª—å–∫—É `BATCH` –≤ `ycqlsh` –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è, –ø—Ä–æ—Å—Ç–æ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –≤—Å—Ç–∞–≤–∫–∏ –ø–æ –æ—Ç–¥–µ–ª—å–Ω–æ—Å—Ç–∏ ‚Äî –¥–ª—è –Ω–∞—à–µ–≥–æ –¥–µ–º–æ-—Ç–µ—Å—Ç–∞ —ç—Ç–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ. –ì–ª–∞–≤–Ω–æ–µ ‚Äî –ø–æ–Ω—è—Ç—å –∫–æ–Ω—Ü–µ–ø—Ü–∏—é.

**–î–∞–≤–∞–π—Ç–µ –ø–µ—Ä–µ–∫–ª—é—á–∏–º—Å—è –Ω–∞ –¥—Ä—É–≥–∏–µ –º–æ—â–Ω—ã–µ –∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ YCQL, –∫–æ—Ç–æ—Ä—ã–µ –æ—Ç–ª–∏—á–Ω–æ —Ä–∞–±–æ—Ç–∞—é—Ç –≤ CLI:**

1.  **–¢–µ—Å—Ç –Ω–∞ —Å–∫–æ—Ä–æ—Å—Ç—å —Ç–æ—á–µ—á–Ω—ã—Ö –≤—Å—Ç–∞–≤–æ–∫ –∏ —á—Ç–µ–Ω–∏–π** (—Å–∏–ª—å–Ω–∞—è —Å—Ç–æ—Ä–æ–Ω–∞ YCQL):
    ```sql
    -- –í—Å—Ç–∞–≤—å—Ç–µ 1000 –∑–∞–ø–∏—Å–µ–π –≤ —Ü–∏–∫–ª–µ (—ç–º—É–ª—è—Ü–∏—è –Ω–∞–≥—Ä—É–∑–∫–∏)
    -- –í ycqlsh –Ω–µ—Ç —Ü–∏–∫–ª–æ–≤, –Ω–æ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Python –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ –≤—Å—Ç–∞–≤–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ
    INSERT INTO test_demo.device_telemetry (device_id, event_time, sensor_id, readings) VALUES ('load_test', toTimestamp(now()), 100, {'temp': 25.5});
    -- –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ —ç—Ç—É –∫–æ–º–∞–Ω–¥—É –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑, –º–µ–Ω—è—è sensor_id

    -- –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ —á—Ç–µ–Ω–∏–µ –ø–æ –∫–ª—é—á—É –ø–∞—Ä—Ç–∏—Ü–∏–∏ (device_id) + clustering column (event_time)
    SELECT * FROM test_demo.device_telemetry WHERE device_id = 'load_test' ORDER BY event_time DESC LIMIT 5;
    ```

2.  **–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è TTL (Time-To-Live) ‚Äî –∞–≤—Ç–æ—É–¥–∞–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö**:
    ```sql
    -- –°–æ–∑–¥–∞–¥–∏–º —Ç–∞–±–ª–∏—Ü—É, –≥–¥–µ —Å—Ç—Ä–æ–∫–∏ –∂–∏–≤—É—Ç 30 —Å–µ–∫—É–Ω–¥
    CREATE TABLE test_demo.temporary_data (
        id text PRIMARY KEY,
        value text
    ) WITH default_time_to_live = 30;

    -- –í—Å—Ç–∞–≤–∏–º –¥–∞–Ω–Ω—ã–µ –∏ –ø–æ—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫ –æ–Ω–∏ –∏—Å—á–µ–∑–Ω—É—Ç
    INSERT INTO test_demo.temporary_data (id, value) VALUES ('test1', 'I will vanish soon');
    SELECT * FROM test_demo.temporary_data; -- –£–≤–∏–¥–∏–º –∑–∞–ø–∏—Å—å
    -- –ü–æ–¥–æ–∂–¥–∏—Ç–µ 30+ —Å–µ–∫—É–Ω–¥ –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–Ω–æ–≤–∞:
    SELECT * FROM test_demo.temporary_data; -- –î–∞–Ω–Ω—ã—Ö –Ω–µ—Ç!
    ```

3.  **–†–∞–±–æ—Ç–∞ —Å–æ —Å–ª–æ–∂–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö (MAP, SET, LIST)**:
    ```sql
    -- –°–æ–∑–¥–∞–¥–∏–º —Ç–∞–±–ª–∏—Ü—É —Å –∫–æ–ª–ª–µ–∫—Ü–∏—è–º–∏
    CREATE TABLE test_demo.user_profile (
        username text PRIMARY KEY,
        emails set<text>,
        preferences map<text, boolean>,
        recent_logins list<timestamp>
    );

    -- –í—Å—Ç–∞–≤–∫–∞ —Å–æ —Å–ª–æ–∂–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏
    INSERT INTO test_demo.user_profile (username, emails, preferences, recent_logins)
    VALUES ('jdoe', {'jdoe@mail.com', 'john@work.com'}, {'email_notifications': true, 'dark_mode': false}, [toTimestamp(now())]);

    -- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–ª–ª–µ–∫—Ü–∏–π
    UPDATE test_demo.user_profile SET emails = emails + {'new@mail.com'} WHERE username = 'jdoe';
    SELECT * FROM test_demo.user_profile;
    ```

4.  **–ú–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ (–¥–µ–Ω–æ—Ä–∞–º–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏)**:
    ```sql
    -- –°–æ–∑–¥–∞–¥–∏–º MV –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ —Ç–µ–ª–µ–º–µ—Ç—Ä–∏–∏ –ø–æ sensor_id
    CREATE MATERIALIZED VIEW test_demo.telemetry_by_sensor AS
        SELECT sensor_id, device_id, event_time, readings
        FROM test_demo.device_telemetry
        WHERE sensor_id IS NOT NULL AND device_id IS NOT NULL AND event_time IS NOT NULL
        PRIMARY KEY ((sensor_id), device_id, event_time);

    -- –¢–µ–ø–µ—Ä—å –±—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫ –ø–æ sensor_id (–∫–æ—Ç–æ—Ä—ã–π —Å—Ç–∞–ª –∫–ª—é—á–æ–º –ø–∞—Ä—Ç–∏—Ü–∏–∏ –≤ MV)
    SELECT * FROM test_demo.telemetry_by_sensor WHERE sensor_id = 100;
    ```

5.  **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ —á—Ç–µ–Ω–∏—è (–æ—Ç–ª–∏—á–∏–µ –æ—Ç eventual consistency Cassandra)**:
    ```sql
    -- –í YCQL –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é STRONG consistency. –ü—Ä–æ–≤–µ—Ä–∏–º:
    CONSISTENCY ALL; -- –£—Å—Ç–∞–Ω–æ–≤–∏–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å (—á—Ç–µ–Ω–∏–µ —Å–æ –≤—Å–µ—Ö —Ä–µ–ø–ª–∏–∫)
    INSERT INTO test_demo.consistency_test (id, value) VALUES ('test', 'value');
    -- –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ —á—Ç–µ–Ω–∏–µ –≤—Å–µ–≥–¥–∞ –≤–µ—Ä–Ω–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    SELECT * FROM test_demo.consistency_test WHERE id = 'test';
    ```

### üìä –ò—Ç–æ–≥: —á—Ç–æ –º—ã —É–∑–Ω–∞–ª–∏ –æ–± YCQL

–ò–∑ —ç—Ç–æ–π –æ—à–∏–±–∫–∏ —Å `BATCH` –≤—ã—Ç–µ–∫–∞–µ—Ç –≤–∞–∂–Ω—ã–π –≤—ã–≤–æ–¥ –¥–ª—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã:

| –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å | YCQL –≤ YugabyteDB | –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è Apache Cassandra |
|-------------|-------------------|-------------------------------|
| **–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏** | –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –Ω–∞ —É—Ä–æ–≤–Ω–µ **–æ–¥–Ω–æ–π –ø–∞—Ä—Ç–∏—Ü–∏–∏**, –Ω–æ —Ç—Ä–µ–±—É—é—Ç –¥—Ä–∞–π–≤–µ—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è | –ù–µ—Ç –Ω–∞—Å—Ç–æ—è—â–∏—Ö ACID-—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π |
| **–°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å** | **Strong –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é** (–ª–∏–Ω–µ–π–Ω–∞—è) | Eventual consistency –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é |
| **–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å** | –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã–π CQL —á–µ—Ä–µ–∑ –¥—Ä–∞–π–≤–µ—Ä—ã, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π `ycqlsh` | –ü–æ–ª–Ω—ã–π CQL —á–µ—Ä–µ–∑ cqlsh |
| **–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã** | –ë—ã—Å—Ç—Ä—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø–æ –∫–ª—é—á—É + –≥–∞—Ä–∞–Ω—Ç–∏–∏ ACID + –≥–∏–±–∫–∞—è —Å—Ö–µ–º–∞ | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –∑–∞–ø–∏—Å–∏ –∏ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ |

### üéØ –ö—Ä–∞—Ç–∫–∏–π –ø–ª–∞–Ω –Ω–∞ –æ—Å—Ç–∞–≤—à–µ–µ—Å—è –≤—Ä–µ–º—è

1.  **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ TTL** ‚Äî —ç—Ç–æ –Ω–∞–≥–ª—è–¥–Ω–∞—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –æ—Ç–ª–∏—á–∏—è –æ—Ç —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏.
2.  **–°–æ–∑–¥–∞–π—Ç–µ –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ** ‚Äî –∫–ª—é—á–µ–≤–æ–π –ø–∞—Ç—Ç–µ—Ä–Ω –¥–µ–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –≤ YCQL.
3.  **–ü–æ—Ä–∞–±–æ—Ç–∞–π—Ç–µ —Å –∫–æ–ª–ª–µ–∫—Ü–∏—è–º–∏ (MAP/SET)** ‚Äî –ø–æ–∫–∞–∂–∏—Ç–µ –≥–∏–±–∫–æ—Å—Ç—å —Å—Ö–µ–º—ã.

–≠—Ç–∏ —Ç—Ä–∏ —Ç–µ—Å—Ç–∞ –∑–∞–π–º—É—Ç 15-20 –º–∏–Ω—É—Ç –∏ –¥–∞–¥—É—Ç –ø–æ–ª–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ –∫–ª—é—á–µ–≤—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è—Ö YCQL. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏—Ö –∏ —Å–æ–æ–±—â–∏—Ç–µ, –∫–∞–∫–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–ª—É—á–∏–ª–∏—Å—å ‚Äî —ç—Ç–æ –ø–æ–º–æ–∂–µ—Ç –¥–≤–∏–≥–∞—Ç—å—Å—è –¥–∞–ª—å—à–µ –∫ Docker-–≤–æ–ø—Ä–æ—Å—É.



-----------------------------------------------------------------



```
–∏ –≤–æ—Ç –µ—â–µ
ycqlsh:test_demo> CREATE INDEX IF NOT EXISTS ON test_demo.device_telemetry (sensor_id);
InvalidRequest: Error from server: code=2200 [Invalid query] message="Invalid Table Definition. Transactions cannot be enabled in an index of a table without transactions enabled.
CREATE INDEX IF NOT EXISTS ON test_demo.device_telemetry (sensor_id);
^^^^^^
 (ql error -302)"
```

–û—Ç–ª–∏—á–Ω–∞—è –Ω–∞—Ö–æ–¥–∫–∞! –≠—Ç–∞ –æ—à–∏–±–∫–∞ —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç –µ—â—ë –æ–¥–Ω—É –≤–∞–∂–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—É—é –¥–µ—Ç–∞–ª—å YugabyteDB. –í–∞—à–∞ —Ç–∞–±–ª–∏—Ü–∞ `device_telemetry` –±—ã–ª–∞ —Å–æ–∑–¥–∞–Ω–∞ **–±–µ–∑ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π** (—ç—Ç–æ –æ–ø—Ü–∏—è –≤ YCQL), –ø–æ—ç—Ç–æ–º—É –Ω–∞ –Ω–µ—ë –Ω–µ–ª—å–∑—è —Å–æ–∑–¥–∞—Ç—å –∏–Ω–¥–µ–∫—Å, –∫–æ—Ç–æ—Ä—ã–π –≤ YugabyteDB —Ç—Ä–µ–±—É–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã—Ö –≥–∞—Ä–∞–Ω—Ç–∏–π –¥–ª—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏.

–≠—Ç–æ –Ω–µ –±–∞–≥, –∞ –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ–µ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ. –î–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä—ë–º—Å—è –∏ –æ–±–æ–π–¥—ë–º —ç—Ç–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ.

### ü§î –ü–æ—á–µ–º—É —Ç–∞–∫ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç?
–í YCQL –µ—Å—Ç—å –¥–≤–∞ —Ç–∏–ø–∞ —Ç–∞–±–ª–∏—Ü:
1.  **–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –≤–µ—Ä—Å–∏—è—Ö)** ‚Äî –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç ACID, –∏–Ω–¥–µ–∫—Å—ã, –≤–Ω–µ—à–Ω–∏–µ –∫–ª—é—á–∏ (—á–µ—Ä–µ–∑ YSQL).
2.  **–ù–µ—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã–µ** ‚Äî —Å–æ–∑–¥–∞—é—Ç—Å—è —Å –æ–ø—Ü–∏–µ–π `WITH transactions = { 'enabled' : false }`. –û–Ω–∏ –±—ã—Å—Ç—Ä–µ–µ –¥–ª—è pure write-heavy –Ω–∞–≥—Ä—É–∑–æ–∫, –Ω–æ **–Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –≤—Ç–æ—Ä–∏—á–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã**.

–í–∞—à–∞ —Ç–∞–±–ª–∏—Ü–∞, —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, —Å–æ–∑–¥–∞–Ω–∞ –∫–∞–∫ –Ω–µ—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–∞—è.

### üîß –ö–∞–∫ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –∏ —Å–æ–∑–¥–∞—Ç—å –∏–Ω–¥–µ–∫—Å

**–í–∞—Ä–∏–∞–Ω—Ç 1: –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É –∫–∞–∫ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—É—é (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è —Ç–µ—Å—Ç–∞)**
```sql
-- 1. –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—É—é —Ç–∞–±–ª–∏—Ü—É (–µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω—ã)
DROP TABLE test_demo.device_telemetry;

-- 2. –°–æ–∑–¥–∞—ë–º –∑–∞–Ω–æ–≤–æ —Å —è–≤–Ω—ã–º —É–∫–∞–∑–∞–Ω–∏–µ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
CREATE TABLE test_demo.device_telemetry (
    device_id text,
    event_time timestamp,
    sensor_id int,
    readings map<text, double>,
    PRIMARY KEY ((device_id), event_time, sensor_id)
) WITH CLUSTERING ORDER BY (event_time DESC, sensor_id ASC)
  AND transactions = { 'enabled' : true }; -- –ö–ª—é—á–µ–≤–∞—è —Å—Ç—Ä–æ–∫–∞!

-- 3. –¢–µ–ø–µ—Ä—å –∏–Ω–¥–µ–∫—Å —Å–æ–∑–¥–∞—Å—Ç—Å—è
CREATE INDEX ON test_demo.device_telemetry (sensor_id);
```

**–í–∞—Ä–∏–∞–Ω—Ç 2: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–∏–ø —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Ç–∞–±–ª–∏—Ü—ã**
```sql
-- –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–≤–æ–π—Å—Ç–≤–∞ —Ç–∞–±–ª–∏—Ü—ã
DESC TABLE test_demo.device_telemetry;
```
–í –≤—ã–≤–æ–¥–µ –Ω–∞–π–¥–∏—Ç–µ —Å—Ç—Ä–æ–∫—É `transactions = {'enabled': 'false'}` ‚Äî —ç—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç –¥–∏–∞–≥–Ω–æ–∑.

### üéØ –ß—Ç–æ —ç—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ–± –∏–¥–µ–æ–ª–æ–≥–∏–∏ YCQL?
1.  **–ì–∏–±–∫–æ—Å—Ç—å –≤—ã–±–æ—Ä–∞**: YugabyteDB –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–±–∏—Ä–∞—Ç—å –º–µ–∂–¥—É –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é (–Ω–µ—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã) –∏ –±–æ–≥–∞—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å—é (—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏).
2.  **–ù–µ –≤—Å–µ –∏–Ω–¥–µ–∫—Å—ã –æ–¥–∏–Ω–∞–∫–æ–≤—ã**: –í—Ç–æ—Ä–∏—á–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö ‚Äî —Å–ª–æ–∂–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è. –í–∫–ª—é—á–∞—è –∏—Ö, —Å–∏—Å—Ç–µ–º–∞ –¥–æ–±–∞–≤–ª—è–µ—Ç overhead –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏.
3.  **–û—Ç–ª–∏—á–∏–µ –æ—Ç Cassandra**: –í –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–π Cassandra –≤—Ç–æ—Ä–∏—á–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –±–µ–∑ —Ç–∞–∫–∏—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π (–Ω–æ –∏ —Ä–∞–±–æ—Ç–∞—é—Ç –≥–æ—Ä–∞–∑–¥–æ –º–µ–Ω–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ, –æ—Å–æ–±–µ–Ω–Ω–æ –Ω–∞ –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö).

### üìã –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å–Ω—ã–π —Ç–µ—Å—Ç (–µ—Å–ª–∏ –Ω–µ —Ö–æ—Ç–∏—Ç–µ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–≤–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É)
–í–º–µ—Å—Ç–æ –∏–Ω–¥–µ–∫—Å–∞ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ **–º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ** ‚Äî —ç—Ç–æ –±–æ–ª–µ–µ "–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π" —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º —Å–ø–æ—Å–æ–± –¥–µ–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ —Ä–∞–∑–Ω—ã–º –∫–ª—é—á–∞–º:

```sql
-- –°–æ–∑–¥–∞—ë–º –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ sensor_id
CREATE MATERIALIZED VIEW test_demo.telemetry_by_sensor AS
    SELECT sensor_id, device_id, event_time, readings
    FROM test_demo.device_telemetry
    WHERE sensor_id IS NOT NULL AND device_id IS NOT NULL AND event_time IS NOT NULL
    PRIMARY KEY ((sensor_id), device_id, event_time);

-- –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–æ –∏—Å–∫–∞—Ç—å
SELECT * FROM test_demo.telemetry_by_sensor WHERE sensor_id = 1;
```

–≠—Ç–æ—Ç –ø–æ–¥—Ö–æ–¥ —á–∞—Å—Ç–æ –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–µ–µ –∏–Ω–¥–µ–∫—Å–æ–≤ –≤ YCQL, —Ç–∞–∫ –∫–∞–∫ —è–≤–Ω–æ –¥–µ–Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –∑–∞–ø—Ä–æ—Å.

### üöÄ –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–≤–æ–¥ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∏–∑—É—á–µ–Ω–∏—è
–ß—Ç–æ–±—ã —É–ª–æ–∂–∏—Ç—å—Å—è –≤ —á–∞—Å-–¥–≤–∞, —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á—å—Ç–µ—Å—å –Ω–∞ —ç—Ç–∏—Ö —Ç—Ä—ë—Ö –∫–ª—é—á–µ–≤—ã—Ö –∫–æ–Ω—Ü–µ–ø—Ü–∏—è—Ö YCQL, –∫–æ—Ç–æ—Ä—ã–µ —É–∂–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–∏:

1.  **–ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö**: –°–æ—Å—Ç–∞–≤–Ω—ã–µ –ø–µ—Ä–≤–∏—á–Ω—ã–µ –∫–ª—é—á–∏ (`PRIMARY KEY (partition_key, clustering_cols)`) + –≥–∏–±–∫–∏–µ —Ç–∏–ø—ã (`MAP`, `SET`).
2.  **–°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å**: –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é `STRONG` (–≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç Cassandra). –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–º —á—Ç–µ–Ω–∏–µ–º –ø–æ—Å–ª–µ –∑–∞–ø–∏—Å–∏.
3.  **–®–∞–±–ª–æ–Ω—ã –¥–æ—Å—Ç—É–ø–∞**: –ë—ã—Å—Ç—Ä—ã–µ –∑–∞–ø—Ä–æ—Å—ã —Ç–æ–ª—å–∫–æ –ø–æ –∫–ª—é—á—É –ø–∞—Ä—Ç–∏—Ü–∏–∏. –î–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ –¥—Ä—É–≥–∏–º –ø–æ–ª—è–º –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ **–º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è**, –∞ –Ω–µ –∏–Ω–¥–µ–∫—Å—ã.

–û—à–∏–±–∫–∞ —Å –∏–Ω–¥–µ–∫—Å–æ–º ‚Äî –Ω–µ —Ç—É–ø–∏–∫, –∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–Ω—è—Ç—å —ç—Ç—É –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—É—é –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é —Ç–∞–±–ª–∏—Ü—É —Å `transactions = { 'enabled' : true }` –∏–ª–∏ –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ ‚Äî –∏ –ø—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ —Ç–µ—Å—Ç—ã.

–ö–∞–∫–æ–π –≤–∞—Ä–∏–∞–Ω—Ç –≤—ã–±–µ—Ä–µ—Ç–µ –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è?


--------------------------------------------------------------------------


```
–≤–æ—Ç –µ—â–µ —É–ø–∞–ª–æ
ycqlsh:test_demo> CREATE MATERIALIZED VIEW test_demo.sensor_to_device AS
             ...     SELECT sensor_id, device_id, event_time, readings
             ...     FROM test_demo.device_telemetry
             ...     WHERE sensor_id IS NOT NULL AND device_id IS NOT NULL AND event_time IS NOT NULL
             ...     PRIMARY KEY ((sensor_id), device_id, event_time); -- –¢–µ–ø–µ—Ä—å sensor_id - –∫–ª—é—á –ø–∞—Ä—Ç–∏—Ü–∏–∏
SyntaxException: <Error from server: code=2000 [Syntax error in CQL query] message="Feature Not Supported
CREATE MATERIALIZED VIEW test_demo.sensor_to_device AS
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    SELECT sensor_id, device_id, event_time, readings
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    FROM test_demo.device_telemetry
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    WHERE sensor_id IS NOT NULL AND device_id IS NOT NULL AND event_time IS NOT NULL
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    PRIMARY KEY ((sensor_id), device_id, event_time);
Invalid SQL Statement. syntax error, unexpected PRIMARY, expecting end_of_file
CREATE MATERIALIZED VIEW test_demo.sensor_to_device AS
    SELECT sensor_id, device_id, event_time, readings
    FROM test_demo.device_telemetry
    WHERE sensor_id IS NOT NULL AND device_id IS NOT NULL AND event_time IS NOT NULL
                                                                                ^^^^
    PRIMARY KEY ((sensor_id), device_id, event_time);
^^^^^^^
 (ql error -11)">
```

–û—Ç–ª–∏—á–Ω–æ! –≠—Ç–∞ –æ—à–∏–±–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç **—Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –æ—Ç–ª–∏—á–∏–µ** YCQL –≤ YugabyteDB –æ—Ç –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–≥–æ Apache Cassandra. **–ú–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è (MV) –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –≤ YCQL YugabyteDB**.

–≠—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–π –º–æ–º–µ–Ω—Ç –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –∏–¥–µ–æ–ª–æ–≥–∏–∏. –î–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä—ë–º, –ø–æ—á–µ–º—É, –∏ —á—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ.

### üö´ –ü–æ—á–µ–º—É –Ω–µ—Ç Materialized Views –≤ YCQL YugabyteDB?
–í –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–π Cassandra MV ‚Äî —ç—Ç–æ —Å–ø–æ—Å–æ–± –¥–µ–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö. –í YugabyteDB —ç—Ç—É —Ä–æ–ª—å –≤—ã–ø–æ–ª–Ω—è—é—Ç –¥—Ä—É–≥–∏–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã:
1. **–í—Ç–æ—Ä–∏—á–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã** (–¥–ª—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü)
2. **–î–µ–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –≤—Ä—É—á–Ω—É—é** (—Å–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã –ø–æ–¥ –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å)
3. **YSQL** (–µ—Å–ª–∏ –Ω—É–∂–Ω—ã —Å–ª–æ–∂–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∏ –¥–∂–æ–π–Ω—ã)

### ‚úÖ –†–∞–±–æ—á–∞—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –í—Ç–æ—Ä–∏—á–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã (—Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ–π)

–¢–∞–∫ –∫–∞–∫ MV –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è, –¥–∞–≤–∞–π—Ç–µ –≤–µ—Ä–Ω—ë–º—Å—è –∫ –∏–Ω–¥–µ–∫—Å–∞–º, –Ω–æ —Å–æ–∑–¥–∞–¥–∏–º —Ç–∞–±–ª–∏—Ü—É **—Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π**:

```sql
-- 1. –°–æ–∑–¥–∞–¥–∏–º –Ω–æ–≤—É—é —Ç–µ—Å—Ç–æ–≤—É—é —Ç–∞–±–ª–∏—Ü—É —Å —è–≤–Ω—ã–º –≤–∫–ª—é—á–µ–Ω–∏–µ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
CREATE TABLE test_demo.telemetry_tx (
    device_id text,
    event_time timestamp,
    sensor_id int,
    readings map<text, double>,
    PRIMARY KEY ((device_id), event_time, sensor_id)
) WITH CLUSTERING ORDER BY (event_time DESC, sensor_id ASC)
  AND transactions = { 'enabled' : true };

-- 2. –°–æ–∑–¥–∞–¥–∏–º –≤—Ç–æ—Ä–∏—á–Ω—ã–π –∏–Ω–¥–µ–∫—Å
CREATE INDEX ON test_demo.telemetry_tx (sensor_id);

-- 3. –í—Å—Ç–∞–≤–∏–º —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
INSERT INTO test_demo.telemetry_tx (device_id, event_time, sensor_id, readings)
VALUES ('device_001', toTimestamp(now()), 1, {'temp': 25.5});
INSERT INTO test_demo.telemetry_tx (device_id, event_time, sensor_id, readings)
VALUES ('device_002', toTimestamp(now()), 1, {'temp': 26.0});
INSERT INTO test_demo.telemetry_tx (device_id, event_time, sensor_id, readings)
VALUES ('device_003', toTimestamp(now()), 2, {'temp': 24.0});

-- 4. –ü—Ä–æ–≤–µ—Ä–∏–º —Ä–∞–±–æ—Ç—É –∏–Ω–¥–µ–∫—Å–∞ (–∑–∞–ø—Ä–æ—Å –ø–æ sensor_id)
SELECT * FROM test_demo.telemetry_tx WHERE sensor_id = 1;
```

### üîÑ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ 2: –†—É—á–Ω–∞—è –¥–µ–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è (–ø–∞—Ç—Ç–µ—Ä–Ω Cassandra)

–ï—Å–ª–∏ –∏–Ω–¥–µ–∫—Å—ã –Ω–µ –ø–æ–¥—Ö–æ–¥—è—Ç, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –ø–∞—Ç—Ç–µ—Ä–Ω ‚Äî **—Å–æ–∑–¥–∞–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –ø–æ–¥ –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å**:

```sql
-- –¢–∞–±–ª–∏—Ü–∞ –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ –ø–æ device_id (–æ—Å–Ω–æ–≤–Ω–∞—è)
CREATE TABLE test_demo.telemetry_by_device (
    device_id text,
    event_time timestamp,
    sensor_id int,
    readings map<text, double>,
    PRIMARY KEY ((device_id), event_time, sensor_id)
);

-- –¢–∞–±–ª–∏—Ü–∞ –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ –ø–æ sensor_id (–¥–µ–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∫–æ–ø–∏—è)
CREATE TABLE test_demo.telemetry_by_sensor (
    sensor_id int,
    device_id text,
    event_time timestamp,
    readings map<text, double>,
    PRIMARY KEY ((sensor_id), device_id, event_time)
);

-- –ü—Ä–∏ –≤—Å—Ç–∞–≤–∫–µ –¥—É–±–ª–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –≤ –æ–±–µ —Ç–∞–±–ª–∏—Ü—ã
INSERT INTO test_demo.telemetry_by_device (device_id, event_time, sensor_id, readings)
VALUES ('device_001', toTimestamp(now()), 1, {'temp': 25.5});
INSERT INTO test_demo.telemetry_by_sensor (sensor_id, device_id, event_time, readings)
VALUES (1, 'device_001', toTimestamp(now()), {'temp': 25.5});
```

### üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–æ–≤ –≤ YCQL YugabyteDB

| –ü–æ–¥—Ö–æ–¥ | –ü–ª—é—Å—ã | –ú–∏–Ω—É—Å—ã | –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å |
|--------|-------|--------|-------------------|
| **–í—Ç–æ—Ä–∏—á–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã** | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ | Overhead –Ω–∞ –∑–∞–ø–∏—Å—å, —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü | –ö–æ–≥–¥–∞ –Ω—É–∂–Ω—ã —Ä–µ–¥–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã –ø–æ –Ω–µ–∫–ª—é—á–µ–≤—ã–º –ø–æ–ª—è–º |
| **–†—É—á–Ω–∞—è –¥–µ–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è** | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö, —Å–ª–æ–∂–Ω–æ—Å—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ | –î–ª—è high-load —Å–∏—Å—Ç–µ–º —Å –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏ |
| **YSQL + JOIN** | –ú–æ—â–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã, –≥–∏–±–∫–æ—Å—Ç—å | –ú–µ–¥–ª–µ–Ω–Ω–µ–µ —Ç–æ—á–µ—á–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ | –î–ª—è –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤, –æ—Ç—á—ë—Ç–æ–≤ |

### üéØ –ò—Ç–æ–≥ –ø–æ YCQL –∑–∞ 1-2 —á–∞—Å–∞

–í—ã —É–∂–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–ª–∏ –∫–ª—é—á–µ–≤—ã–µ –∞—Å–ø–µ–∫—Ç—ã YCQL –≤ YugabyteDB:
1. ‚úÖ **–ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö**: –°–æ—Å—Ç–∞–≤–Ω—ã–µ –ø–µ—Ä–≤–∏—á–Ω—ã–µ –∫–ª—é—á–∏, –∫–æ–ª–ª–µ–∫—Ü–∏–∏
2. ‚úÖ **–°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å**: Strong consistency –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
3. ‚úÖ **–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø–∞—Ä—Ç–∏—Ü–∏–∏ (—á–µ—Ä–µ–∑ –¥—Ä–∞–π–≤–µ—Ä—ã)
4. ‚ùå **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è**: –ù–µ—Ç `BATCH` –≤ CLI, –Ω–µ—Ç `MATERIALIZED VIEW`
5. üîÑ **–ü–æ–¥—Ö–æ–¥ –∫ –∏–Ω–¥–µ–∫—Å–∞–º**: –¢–æ–ª—å–∫–æ –¥–ª—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü

**–ö–ª—é—á–µ–≤–æ–π –≤—ã–≤–æ–¥**: YCQL –≤ YugabyteDB ‚Äî —ç—Ç–æ **–Ω–µ 100% Cassandra**, –∞ **–≥–∏–±—Ä–∏–¥**:
- –í–∑—è–ª **–º–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö –∏ –±—ã—Å—Ç—Ä—ã–µ –∑–∞–ø—Ä–æ—Å—ã –ø–æ –∫–ª—é—á—É** –∏–∑ Cassandra
- –î–æ–±–∞–≤–∏–ª **—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∏ strong consistency** –∏–∑ SQL-–º–∏—Ä–∞
- –£–±—Ä–∞–ª –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ NoSQL-—Ñ—É–Ω–∫—Ü–∏–∏ (MV, eventual consistency)

### –ß—Ç–æ –¥–∞–ª—å—à–µ?
–ü–æ–ø—Ä–æ–±—É–π—Ç–µ:
1. **–°–æ–∑–¥–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –∏ –∏–Ω–¥–µ–∫—Å** (–ø–µ—Ä–≤—ã–π –ø—Ä–∏–º–µ—Ä –≤—ã—à–µ)
2. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–∫–æ—Ä–æ—Å—Ç—å —Ç–æ—á–µ—á–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤** –ø–æ `device_id` vs –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ –∏–Ω–¥–µ–∫—Å—É `sensor_id`
3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏** –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ YugabyteDB (`http://<node-ip>:7000`)

–≠—Ç–æ –¥–∞—Å—Ç –ø–æ–ª–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ–± –∏–¥–µ–æ–ª–æ–≥–∏–∏ YCQL. –ì–æ—Ç–æ–≤—ã –ø–µ—Ä–µ–π—Ç–∏ –∫ Docker-–≤–æ–ø—Ä–æ—Å—É, –∏–ª–∏ —Ö–æ—Ç–∏—Ç–µ –µ—â—ë —á—Ç–æ-—Ç–æ —É—Ç–æ—á–Ω–∏—Ç—å –ø–æ YCQL?


-------------------------------------------------------------------------------

```
—Å—Ç—Ä–∞–Ω–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ
ycqlsh:stress> TRACING ON;
Now Tracing is enabled
ycqlsh:stress> SELECT bucket, COUNT(*) FROM ycql_perf_test GROUP BY bucket LIMIT 5;
SyntaxException: <Error from server: code=2000 [Syntax error in CQL query] message="Invalid CQL Statement. Selecting aggregate together with rows of non-aggregate values is not allowed
SELECT bucket, COUNT(*) FROM ycql_perf_test GROUP BY bucket LIMIT 5;
       ^^^^^^
 (ql error -12)">
ycqlsh:stress> TRACING OFF;
Disabled Tracing.

—á—Ç–æ —Ç—É—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç?
–∏ –∑–∞—á–µ–º –Ω–∞–º –Ω—É–∂–µ–Ω –∫–ª—é—á TRACING?
—á—Ç–æ –æ–Ω –¥–∞–µ—Ç?
```

–≠—Ç–∏ –¥–≤–µ –æ—à–∏–±–∫–∏ –∏–¥–µ–∞–ª—å–Ω–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—Ç —Ñ–∏–ª–æ—Å–æ—Ñ–∏—é YCQL! –î–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä–µ–º –∫–∞–∂–¥—É—é.

## 1. –û—à–∏–±–∫–∞ —Å `GROUP BY`: –ü–æ—á–µ–º—É –Ω–µ–ª—å–∑—è —Å–º–µ—à–∏–≤–∞—Ç—å –∞–≥—Ä–µ–≥–∞—Ç—ã —Å –æ–±—ã—á–Ω—ã–º–∏ –ø–æ–ª—è–º–∏

–≠—Ç–æ **–Ω–µ –±–∞–≥, –∞ –ø—Ä–∏–Ω—Ü–∏–ø–∏–∞–ª—å–Ω–∞—è –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å CQL** (—è–∑—ã–∫–∞ Cassandra/YCQL). –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç SQL, –≥–¥–µ –º–æ–∂–Ω–æ —Å–≤–æ–±–æ–¥–Ω–æ —Å–º–µ—à–∏–≤–∞—Ç—å –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏ –Ω–µ–∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—è, –≤ CQL –¥–µ–π—Å—Ç–≤—É–µ—Ç —Å—Ç—Ä–æ–≥–æ–µ –ø—Ä–∞–≤–∏–ª–æ:

> **–ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –∞–≥—Ä–µ–≥–∏—Ä—É—é—â—É—é —Ñ—É–Ω–∫—Ü–∏—é (COUNT, SUM, AVG), —Ç–æ –≤ SELECT –º–æ–∂–Ω–æ –≤–∫–ª—é—á–∞—Ç—å –¢–û–õ–¨–ö–û:**
> 1. –°–∞–º–∏ –∞–≥—Ä–µ–≥–∏—Ä—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
> 2. –¢–µ –ø–æ–ª—è, –∫–æ—Ç–æ—Ä—ã–µ —É–∫–∞–∑–∞–Ω—ã –≤ `GROUP BY`

**–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ (–∫–∞–∫ —É –≤–∞—Å):**
```sql
SELECT bucket, COUNT(*) FROM ycql_perf_test GROUP BY bucket;
-- –û—à–∏–±–∫–∞: bucket —É–∂–µ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è "—Å—ã—Ä—ã–º" –∑–Ω–∞—á–µ–Ω–∏–µ–º —Å—Ç—Ä–æ–∫–∏, –∞ –∫–ª—é—á–æ–º –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏
```

**–ü—Ä–∞–≤–∏–ª—å–Ω–æ (—Ä–∞–±–æ—Ç–∞—é—â–∏–π –≤–∞—Ä–∏–∞–Ω—Ç –¥–ª—è YCQL):**
```sql
-- –¢–û–õ–¨–ö–û –µ—Å–ª–∏ bucket - —á–∞—Å—Ç—å –ø–µ—Ä–≤–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞ –∏–ª–∏ –µ—Å—Ç—å –∏–Ω–¥–µ–∫—Å
SELECT COUNT(*) FROM ycql_perf_test GROUP BY bucket;
-- –∏–ª–∏
SELECT bucket, COUNT(*) FROM ycql_perf_test WHERE bucket IN (1,2,3,4,5);
-- –Ω–æ –≤—Ç–æ—Ä–æ–π –≤–∞—Ä–∏–∞–Ω—Ç —Å WHERE —Ç–æ–∂–µ –º–æ–∂–µ—Ç –Ω–µ —Å—Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –∫–ª—é—á–∞
```

**–ü–æ—á–µ–º—É —Ç–∞–∫?** YCQL –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è **—Ç–æ—á–µ—á–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ –∫–ª—é—á—É**, –∞ –Ω–µ –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏. –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–µ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –ø–æ –≤—Å–µ–º –¥–∞–Ω–Ω—ã–º (`GROUP BY` –±–µ–∑ —Ñ–∏–ª—å—Ç—Ä–∞ –ø–æ –∫–ª—é—á—É –ø–∞—Ä—Ç–∏—Ü–∏–∏) ‚Äî —ç—Ç–æ —Å–ª–∞–±–æ–µ –º–µ—Å—Ç–æ YCQL. –î–ª—è —ç—Ç–æ–≥–æ –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **YSQL**.

### üìå –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –∞–≥—Ä–µ–≥–∞—Ü–∏–π –≤ YCQL

–ü–æ–ø—Ä–æ–±—É–π—Ç–µ —ç—Ç–∏ –∑–∞–ø—Ä–æ—Å—ã, —á—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å –≥—Ä–∞–Ω–∏—Ü—ã:

```sql
-- 1. –ê–≥—Ä–µ–≥–∞—Ü–∏—è –í–°–ï–ô —Ç–∞–±–ª–∏—Ü—ã (–±—É–¥–µ—Ç –ú–ï–î–õ–ï–ù–ù–û –∏–ª–∏ —Å –æ—à–∏–±–∫–æ–π)
SELECT COUNT(*) FROM ycql_perf_test;

-- 2. –ê–≥—Ä–µ–≥–∞—Ü–∏—è –ø–æ –ö–û–ù–ö–†–ï–¢–ù–û–ú–£ –∫–ª—é—á—É –ø–∞—Ä—Ç–∏—Ü–∏–∏ (–±—ã—Å—Ç—Ä–æ)
SELECT COUNT(*) FROM ycql_perf_test WHERE bucket = 1;

-- 3. –ü–æ–ø—ã—Ç–∫–∞ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –ø–æ –ù–ï–∫–ª—é—á–µ–≤–æ–º—É –ø–æ–ª—é (—Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ –æ—à–∏–±–∫–∞)
SELECT COUNT(*) FROM ycql_perf_test GROUP BY item_id;
```

## 2. –ß—Ç–æ —Ç–∞–∫–æ–µ `TRACING` –∏ –∑–∞—á–µ–º –æ–Ω –Ω—É–∂–µ–Ω

`TRACING` ‚Äî —ç—Ç–æ **–≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤—â–∏–∫ –∑–∞–ø—Ä–æ—Å–æ–≤**, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "–∑–∞–∫—É–ª–∏—Å–Ω—É—é" —Ä–∞–±–æ—Ç—É YCQL. –û–Ω –æ—Ç–≤–µ—Ç–∏—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å: **"–ü–æ—á–µ–º—É —ç—Ç–æ—Ç –∑–∞–ø—Ä–æ—Å —Ç–∞–∫–æ–π –º–µ–¥–ª–µ–Ω–Ω—ã–π?"**

**–í–∫–ª—é—á–∏—Ç–µ TRACING –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –ø—Ä–æ—Å—Ç–æ–π –∑–∞–ø—Ä–æ—Å:**
```sql
TRACING ON;
SELECT * FROM ycql_perf_test WHERE bucket = 1 AND item_id = 'item_1' LIMIT 1;
```

–í—ã —É–≤–∏–¥–∏—Ç–µ –ø–æ–¥—Ä–æ–±–Ω—ã–π –≤—ã–≤–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –≤–∫–ª—é—á–∞–µ—Ç:

| –ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç | –ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç |
|----------------|--------------|
| **activity** | –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–æ –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ |
| **source** | –° –∫–∞–∫–æ–≥–æ —É–∑–ª–∞ –ø—Ä–∏—à–ª–∏ –¥–∞–Ω–Ω—ã–µ |
| **elapsed time** | –í—Ä–µ–º—è –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ (–º–∏–∫—Ä–æ—Å–µ–∫—É–Ω–¥—ã) |
| **keyspace** | –í –∫–∞–∫–æ–º –∫–ª—é—Å–ø–µ–π—Å–µ –∏—Å–∫–∞–ª–∏ |
| **tablets** | –ù–∞ –∫–∞–∫–∏—Ö —Ç–∞–±–ª–µ—Ç–∞—Ö (shards) –∏—Å–∫–∞–ª–∏ –¥–∞–Ω–Ω—ã–µ |

**–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞ TRACING:**
```
Tracing session: 12345678-1234-1234-1234-123456789012

 activity                                                                                     | timestamp    | source    | elapsed | details
---------------------------------------------------------------------------------------------+--------------+-----------+---------+-------------------
 Execute CQL3 query                                                                          | 12:34:56.789 | 127.0.0.1 |   0.123 | Query: SELECT...
 Read request complete                                                                       | 12:34:56.789 | 127.0.0.1 |   0.456 | Rows: 1
 Request complete                                                                            | 12:34:56.789 | 127.0.0.1 |   0.789 | 
```

### üéØ –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ TRACING

1. **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤:**
   ```sql
   TRACING ON;
   -- –ú–µ–¥–ª–µ–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å
   SELECT * FROM ycql_perf_test WHERE sensor_id = 100; 
   -- –°–º–æ—Ç—Ä–∏—Ç–µ, —Å–∫–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏ —É—à–ª–æ –Ω–∞ "Read request complete"
   ```

2. **–ü–æ–Ω–∏–º–∞–Ω–∏–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤:**
   ```sql
   TRACING ON;
   -- –ó–∞–ø—Ä–æ—Å –ø–æ –∫–ª—é—á—É –ø–∞—Ä—Ç–∏—Ü–∏–∏
   SELECT * FROM ycql_perf_test WHERE bucket = 1;
   -- –£–≤–∏–¥–∏—Ç–µ, —á—Ç–æ –∑–∞–ø—Ä–æ—Å –æ–±—Ä–∞–±–æ—Ç–∞–Ω –Ω–∞ 1-2 —Ç–∞–±–ª–µ—Ç–∞—Ö (–±—ã—Å—Ç—Ä–æ)
   ```

3. **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏:**
   ```sql
   TRACING ON;
   -- –ó–∞–ø—Ä–æ—Å 1: –ü–æ –∫–ª—é—á—É –ø–∞—Ä—Ç–∏—Ü–∏–∏
   SELECT * FROM ycql_perf_test WHERE bucket = 1 AND item_id = 'item_1';
   
   TRACING ON;
   -- –ó–∞–ø—Ä–æ—Å 2: –ë–µ–∑ –∫–ª—é—á–∞ –ø–∞—Ä—Ç–∏—Ü–∏–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å –∏–Ω–¥–µ–∫—Å)
   SELECT * FROM ycql_perf_test WHERE item_id = 'item_1';
   -- –£–≤–∏–¥–∏—Ç–µ —Ä–∞–∑–Ω–∏—Ü—É –≤–æ –≤—Ä–µ–º–µ–Ω–∏ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –∑–∞–¥–µ–π—Å—Ç–≤–æ–≤–∞–Ω–Ω—ã—Ö —Ç–∞–±–ª–µ—Ç–æ–≤
   ```

### üìä –ë—ã—Å—Ç—Ä—ã–π —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç —Å TRACING

```sql
-- 1. –í–∫–ª—é—á–∏—Ç–µ —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫—É
TRACING ON;

-- 2. –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—Ä–æ—Å –ø–æ –ø–æ–ª–Ω–æ–º—É –∫–ª—é—á—É
SELECT * FROM stress.ycql_perf_test WHERE bucket = 1 AND item_id = 'item_1';

-- 3. –ó–∞–ø—Ä–æ—Å —Ç–æ–ª—å–∫–æ –ø–æ —á–∞—Å—Ç–∏ –∫–ª—é—á–∞ (—Ç–æ–∂–µ –±—ã—Å—Ç—Ä–æ)
SELECT * FROM stress.ycql_perf_test WHERE bucket = 1 LIMIT 5;

-- 4. –ó–∞–ø—Ä–æ—Å –ë–ï–ó –∫–ª—é—á–∞ –ø–∞—Ä—Ç–∏—Ü–∏–∏ (–µ—Å–ª–∏ —Å–æ–∑–¥–∞–ª–∏ –∏–Ω–¥–µ–∫—Å)
SELECT * FROM stress.ycql_perf_test WHERE item_id = 'item_1' LIMIT 5;

-- 5. –í—ã–∫–ª—é—á–∏—Ç–µ —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫—É
TRACING OFF;
```

–°—Ä–∞–≤–Ω–∏—Ç–µ –≤—ã–≤–æ–¥ –¥–ª—è –ø—É–Ω–∫—Ç–æ–≤ 2, 3 –∏ 4. –í—ã —É–≤–∏–¥–∏—Ç–µ:
- **–ü—É–Ω–∫—Ç 2 –∏ 3:** –ú–∞–ª–µ–Ω—å–∫–æ–µ `elapsed time` (–æ–±—ã—á–Ω–æ < 1ms), –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ 1-2 —Ç–∞–±–ª–µ—Ç–∞–º
- **–ü—É–Ω–∫—Ç 4:** –ë–æ–ª—å—à–µ–µ –≤—Ä–µ–º—è, –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫–æ –º–Ω–æ–≥–∏–º —Ç–∞–±–ª–µ—Ç–∞–º (scatter-gather –∑–∞–ø—Ä–æ—Å)

## üíé –ò—Ç–æ–≥ –∑–∞ 5 –º–∏–Ω—É—Ç

1. **YCQL –Ω–µ SQL:** –ù–µ–ª—å–∑—è —Å–≤–æ–±–æ–¥–Ω–æ —Å–º–µ—à–∏–≤–∞—Ç—å –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ —Å –æ–±—ã—á–Ω—ã–º–∏ –ø–æ–ª—è–º–∏. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `GROUP BY` —Ç–æ–ª—å–∫–æ –ø–æ –∫–ª—é—á–∞–º –ø–∞—Ä—Ç–∏—Ü–∏–∏ –∏–ª–∏ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –≤ YSQL –¥–ª—è —Å–ª–æ–∂–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–∏.

2. **TRACING ‚Äî –≤–∞—à –ª—É—á—à–∏–π –¥—Ä—É–≥** –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. –û–Ω –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
   - –°–∫–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏ —Ç—Ä–∞—Ç–∏—Ç—Å—è –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ
   - –ö –∫–∞–∫–∏–º —É–∑–ª–∞–º/—Ç–∞–±–ª–µ—Ç–∞–º –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –∑–∞–ø—Ä–æ—Å
   - –ì–¥–µ "–±—É—Ç—ã–ª–æ—á–Ω–æ–µ –≥–æ—Ä–ª—ã—à–∫–æ"

3. **–ö–ª—é—á–µ–≤–æ–π –≤—ã–≤–æ–¥ –ø–æ YCQL:** –ï—Å–ª–∏ –≤–∞—à –∑–∞–ø—Ä–æ—Å –≤ TRACING –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫–æ –º–Ω–æ–≥–∏–º —Ç–∞–±–ª–µ—Ç–∞–º (`tablets`) ‚Äî –≤—ã –¥–µ–ª–∞–µ—Ç–µ —á—Ç–æ-—Ç–æ –Ω–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –¥–ª—è YCQL. –ò–¥–µ–∞–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å –≤ YCQL –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –∫ 1-2 —Ç–∞–±–ª–µ—Ç–∞–º.

**–°–æ–≤–µ—Ç:** –°–¥–µ–ª–∞–π—Ç–µ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ç–µ—Å—Ç —Å TRACING –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∏ –º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤ ‚Äî —ç—Ç–æ –¥–∞—Å—Ç –≤–∞–º –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ YCQL –∑–∞ 10 –º–∏–Ω—É—Ç.
