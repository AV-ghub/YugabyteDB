–í—ã –ø—Ä–∞–≤—ã, —É–∫–∞–∑—ã–≤–∞—è –Ω–∞ –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å —Å–µ—Ç—å—é –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞. –û—à–∏–±–∫–∞ —Å–≤—è–∑–∞–Ω–∞ —Å **—É—Å—Ç–∞—Ä–µ–≤—à–∏–º–∏ –∏–ª–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ –∫–æ—Ä–Ω–µ–≤—ã–º–∏ SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞–º–∏ –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞**, –∏–∑-–∑–∞ —á–µ–≥–æ –æ–Ω –Ω–µ –º–æ–∂–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –≤–Ω–µ—à–Ω–∏–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è–º AlmaLinux. –≠—Ç–æ –Ω–µ –ø—Ä–∏–Ω—Ü–∏–ø–∏–∞–ª—å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞, –∞ —Ç–∏–ø–∏—á–Ω–∞—è —Å–∏—Ç—É–∞—Ü–∏—è, –∫–æ—Ç–æ—Ä—É—é –º–æ–∂–Ω–æ —Ä–µ—à–∏—Ç—å.

–û—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞ ‚Äî —Å–∏—Å—Ç–µ–º–∞ –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –Ω–µ –¥–æ–≤–µ—Ä—è–µ—Ç —Ü–µ–ø–æ—á–∫–µ SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –≤–Ω–µ—à–Ω–µ–≥–æ –∑–µ—Ä–∫–∞–ª–∞. –†–µ—à–µ–Ω–∏–µ ‚Äî –æ–±–Ω–æ–≤–∏—Ç—å –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ –ø–∞–∫–µ—Ç –∫–æ—Ä–Ω–µ–≤—ã—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ (`ca-certificates`). –ü–∞—Ä–∞–¥–æ–∫—Å –≤ —Ç–æ–º, —á—Ç–æ –¥–ª—è —ç—Ç–æ–≥–æ –Ω—É–∂–Ω–æ —Å–Ω–∞—á–∞–ª–∞ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –µ–≥–æ —á–µ—Ä–µ–∑ `yum`, –∫–æ—Ç–æ—Ä—ã–π –∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç.

–î–ª—è –≤—ã—Ö–æ–¥–∞ –∏–∑ —ç—Ç–æ–≥–æ "–∑–∞–º–∫–Ω—É—Ç–æ–≥–æ –∫—Ä—É–≥–∞" –µ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã.

### üîß –°–ø–æ—Å–æ–±—ã —Ä–µ—à–µ–Ω–∏—è –∏ –∏—Ö –≤—ã–±–æ—Ä

–ü–æ—Å–∫–æ–ª—å–∫—É –ø—Ä—è–º–æ–µ —Ä–µ—à–µ–Ω–∏–µ —á–µ—Ä–µ–∑ `yum` –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ, —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –ø—É—Ç–∏. –ù–∏–∂–µ –ø—Ä–∏–≤–µ–¥–µ–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–º–æ–∂–µ—Ç –≤—ã–±—Ä–∞—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π.

| –ú–µ—Ç–æ–¥ —Ä–µ—à–µ–Ω–∏—è | –°–ª–æ–∂–Ω–æ—Å—Ç—å | –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è, –µ—Å–ª–∏... | –û—Å–Ω–æ–≤–Ω–æ–π —Ä–∏—Å–∫/–∑–∞—Ç—Ä–∞—Ç—ã |
| :--- | :--- | :--- | :--- |
| **–í—Ä–µ–º–µ–Ω–Ω—ã–π –æ–±—Ö–æ–¥ SSL (–≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ)** | –ù–∏–∑–∫–∞—è | –ù—É–∂–Ω–æ –±—ã—Å—Ç—Ä–æ –ø–æ—Å—Ç–∞–≤–∏—Ç—å PostGIS –¥–ª—è —Ç–µ—Å—Ç–æ–≤. | **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** –≤—Ä–µ–º–µ–Ω–Ω–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ SSL. |
| **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ (—Å —Ö–æ—Å—Ç–∞)** | –°—Ä–µ–¥–Ω—è—è | –ï—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ –ø–∞–∫–µ—Ç—É –Ω–∞ —Ö–æ—Å—Ç–µ –∏–ª–∏ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç. | **–í—Ä–µ–º—è:** –Ω—É–∂–Ω–æ –Ω–∞–π—Ç–∏ –∏ —Å–∫–∞—á–∞—Ç—å –ø–∞–∫–µ—Ç –≤—Ä—É—á–Ω—É—é. |
| **–°–±–æ—Ä–∫–∞ —Å–≤–æ–µ–≥–æ Docker-–æ–±—Ä–∞–∑–∞** | –°—Ä–µ–¥–Ω—è—è/–í—ã—Å–æ–∫–∞—è | –¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞–¥–µ–∂–Ω–æ–µ, –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ–µ —Ä–µ—à–µ–Ω–∏–µ. | **–í—Ä–µ–º—è:** –Ω—É–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å –∏ –æ—Ç–ª–∞–¥–∏—Ç—å Dockerfile. |

### üõ†Ô∏è 1. –í—Ä–µ–º–µ–Ω–Ω—ã–π –æ–±—Ö–æ–¥ –ø—Ä–æ–≤–µ—Ä–∫–∏ SSL (—Å–∞–º—ã–π –±—ã—Å—Ç—Ä—ã–π —Å–ø–æ—Å–æ–±)

–≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –ø–æ–∑–≤–æ–ª–∏—Ç –≤–∞–º —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `ca-certificates` –∏ PostGIS, –º–∏–Ω—É—è –±–ª–æ–∫–∏—Ä—É—é—â—É—é –æ—à–∏–±–∫—É.

1.  –í–æ–π–¥–∏—Ç–µ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä:
    ```bash
    docker exec -it yugabyte_yb-tserver-a_1 bash
    ```
2.  –í—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫—É SSL –¥–ª—è `yum`, –¥–æ–±–∞–≤–∏–≤ —Å—Ç—Ä–æ–∫—É –≤ –µ–≥–æ –∫–æ–Ω—Ñ–∏–≥:
    ```bash
    echo "sslverify=0" >> /etc/yum.conf
    ```
3.  –¢–µ–ø–µ—Ä—å —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `ca-certificates` –∏ PostGIS:
    ```bash
    yum update -y
    yum install -y ca-certificates postgis31_15
    ```
4.  **–ö—Ä–∞–π–Ω–µ –≤–∞–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏:**
    ```bash
    # –£–¥–∞–ª–∏—Ç–µ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—É—é —Å—Ç—Ä–æ–∫—É –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
    sed -i '/^sslverify=0/d' /etc/yum.conf
    ```

### üì¶ 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–∞ `ca-certificates` –≤—Ä—É—á–Ω—É—é (–±–µ–∑–æ–ø–∞—Å–Ω–µ–µ)

–≠—Ç–æ—Ç —Å–ø–æ—Å–æ–± –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –æ—Ç–∫–ª—é—á–µ–Ω–∏—è SSL. –ù—É–∂–Ω–æ —Å–∫–∞—á–∞—Ç—å –ø–∞–∫–µ—Ç —Å —Ö–æ—Å—Ç–∞ –∏ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä.

1.  **–ù–∞ –≤–∞—à–µ–º —Ö–æ—Å—Ç–µ (CentOS 7)** –Ω–∞–π–¥–∏—Ç–µ –∏ —Å–∫–∞—á–∞–π—Ç–µ –ø–∞–∫–µ—Ç `ca-certificates` –¥–ª—è AlmaLinux 8. –ï–≥–æ –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–∞ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–º –∑–µ—Ä–∫–∞–ª–µ: [mirrors.almalinux.org](https://mirrors.almalinux.org/mirrorlist/8/baseos) (—Å–ø–∏—Å–æ–∫ —Å–æ–¥–µ—Ä–∂–∏—Ç HTTP-—Å—Å—ã–ª–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ —Ç—Ä–µ–±—É—é—Ç SSL).
2.  –°–∫–∞—á–∞–π—Ç–µ –ø–∞–∫–µ—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ `wget`) –∏ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –µ–≥–æ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä:
    ```bash
    # –ù–∞ —Ö–æ—Å—Ç–µ
    docker cp /–ø—É—Ç—å/–∫/ca-certificates-*.rpm yugabyte_yb-tserver-a_1:/tmp/
    ```
3.  **–í–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞** —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–∞–∫–µ—Ç –≤—Ä—É—á–Ω—É—é:
    ```bash
    rpm -ivh --nodeps /tmp/ca-certificates-*.rpm
    update-ca-trust force-enable
    update-ca-trust extract
    ```
4.  –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ `yum update` –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ PostGIS –¥–æ–ª–∂–Ω—ã –∑–∞—Ä–∞–±–æ—Ç–∞—Ç—å.

### üê≥ 3. –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ Docker-–æ–±—Ä–∞–∑–∞ (—Å–∞–º—ã–π –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–±)

–≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –ø–æ–∑–≤–æ–ª–∏—Ç –≤–∞–º —Å–æ–∑–¥–∞—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –æ–±—Ä–∞–∑ —Å —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º PostGIS, –º–∏–Ω—É—è –≤—Å–µ –ø—Ä–æ–±–ª–µ–º—ã —Å SSL –≤ –±—É–¥—É—â–µ–º.

1.  –°–æ–∑–¥–∞–π—Ç–µ `Dockerfile` –Ω–∞ –≤–∞—à–µ–º —Ö–æ—Å—Ç–µ:
    ```dockerfile
    FROM yugabytedb/yugabyte:latest
    USER root
    # –í—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–∞–µ–º SSL –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏, –∑–∞—Ç–µ–º –≤–∫–ª—é—á–∞–µ–º –æ–±—Ä–∞—Ç–Ω–æ
    RUN echo "sslverify=0" >> /etc/yum.conf && \
        yum update -y && \
        yum install -y ca-certificates postgis31_15 && \
        sed -i '/^sslverify=0/d' /etc/yum.conf && \
        update-ca-trust extract
    # –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ PostGIS –≤ –Ω—É–∂–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ YugabyteDB
    RUN cp -r /usr/pgsql-15/share/extension/*postgis* /home/yugabyte/share/postgresql/extension/ && \
        cp -r /usr/pgsql-15/share/contrib/postgis-3.1 /home/yugabyte/share/postgresql/contrib/ && \
        cp /usr/pgsql-15/lib/postgis-3.1.so /home/yugabyte/lib/postgresql/
    USER yugabyte
    ```
2.  –°–æ–±–µ—Ä–∏—Ç–µ –∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ—Ç –æ–±—Ä–∞–∑, –æ–±–Ω–æ–≤–∏–≤ `docker-compose.yml`.
