–î–∞, –ø–µ—Ä–µ—Å–æ–∑–¥–∞–¥–∏–º –≤—Å–µ —Å —á–∏—Å—Ç–æ–≥–æ –ª–∏—Å—Ç–∞ —Å **–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –∫–æ–Ω—Ñ–∏–≥–æ–º**. –ü—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–æ–º, —á—Ç–æ –Ω–∞—à —Ç–µ–∫—É—â–∏–π –∫–ª–∞—Å—Ç–µ—Ä –≤ "–ø–æ–ª–æ–º–∞–Ω–Ω–æ–º" —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –∏–∑-–∑–∞ –Ω–µ–∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫.

### üéØ –ù–æ–≤—ã–π 100% —Ä–∞–±–æ—á–∏–π –∫–æ–Ω—Ñ–∏–≥ –¥–ª—è CentOS 7

–°–æ–∑–¥–∞–π—Ç–µ **–Ω–æ–≤—ã–π –∫–∞—Ç–∞–ª–æ–≥** –∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–æ–≤—ã–π `docker-compose.yml`:

```bash
# 1. –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é (—á—Ç–æ–±—ã –Ω–µ –º–µ—à–∞—Ç—å —Å–æ —Å—Ç–∞—Ä—ã–º)
mkdir ~/yugabyte-prod && cd ~/yugabyte-prod
```

```yaml
# docker-compose.yml
# –†–ê–ë–û–ß–ê–Ø –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞
version: '3.8'

services:
  # –ú–∞—Å—Ç–µ—Ä-—É–∑–µ–ª (—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏)
  yb-master:
    image: yugabytedb/yugabyte:latest
    command:
      - "/home/yugabyte/bin/yb-master"
      - "--fs_data_dirs=/mnt/master"
      - "--master_addresses=yb-master:7100"
      - "--rpc_bind_addresses=yb-master:7100"
      - "--replication_factor=3"  # –ö–ª—é—á–µ–≤–æ–µ: RF=3 –¥–ª—è 3 TServer!
    mem_limit: 1024m
    ports:
      - "7000:7000"  # –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

  # –¢—Ä–∏ TServer —É–∑–ª–∞ –î–û–õ–ñ–ù–´ –∏–º–µ—Ç—å –†–ê–ó–ù–´–ï –ø–æ—Ä—Ç—ã –Ω–∞—Ä—É–∂—É
  yb-tserver-a:
    image: yugabytedb/yugabyte:latest
    command:
      - "/home/yugabyte/bin/yb-tserver"
      - "--fs_data_dirs=/mnt/tserver"
      - "--tserver_master_addrs=yb-master:7100"
      - "--rpc_bind_addresses=yb-tserver-a:9100"
      - "--enable_ysql"
      - "--ysql_enable_auth=false"
      - "--pgsql_proxy_bind_address=0.0.0.0:5433"
    ports:
      - "5433:5433"  # –û—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ä—Ç –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
    depends_on:
      - yb-master
    mem_limit: 2048m

  yb-tserver-b:
    image: yugabytedb/yugabyte:latest
    command:
      - "/home/yugabyte/bin/yb-tserver"
      - "--fs_data_dirs=/mnt/tserver"
      - "--tserver_master_addrs=yb-master:7100"
      - "--rpc_bind_addresses=yb-tserver-b:9100"
      - "--enable_ysql"
      - "--ysql_enable_auth=false"
      - "--pgsql_proxy_bind_address=0.0.0.0:5433"
    ports:
      - "5434:5433"  # –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø–æ—Ä—Ç
    depends_on:
      - yb-master
    mem_limit: 2048m

  yb-tserver-c:
    image: yugabytedb/yugabyte:latest
    command:
      - "/home/yugabyte/bin/yb-tserver"
      - "--fs_data_dirs=/mnt/tserver"
      - "--tserver_master_addrs=yb-master:7100"
      - "--rpc_bind_addresses=yb-tserver-c:9100"
      - "--enable_ysql"
      - "--ysql_enable_auth=false"
      - "--pgsql_proxy_bind_address=0.0.0.0:5433"
    ports:
      - "5435:5433"  # –ï—â–µ –æ–¥–∏–Ω –ø–æ—Ä—Ç
    depends_on:
      - yb-master
    mem_limit: 2048m
```

### üöÄ –ü–æ—à–∞–≥–æ–≤—ã–π –∑–∞–ø—É—Å–∫ —Å –≥–∞—Ä–∞–Ω—Ç–∏–µ–π

```bash
# 1. –û–ß–ò–°–¢–ö–ê –í–°–ï–ì–û —Å—Ç–∞—Ä–æ–≥–æ (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ!)
cd ~/yugabyte-prod
docker-compose down -v --remove-orphans 2>/dev/null || true

# –£–±–∏–≤–∞–µ–º –í–°–ï –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã Yugabyte
docker ps -aq --filter "name=yugabyte" --filter "ancestor=yugabytedb/yugabyte" | xargs -r docker rm -f

# –ß–∏—Å—Ç–∏–º —Ç–æ–º–∞
docker volume prune -f
docker network prune -f

# 2. –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –ø–æ—Ä—Ç—ã —Å–≤–æ–±–æ–¥–Ω—ã
sudo ss -tulpn | grep -E ':(5433|5434|5435|7000)' || echo "–ü–æ—Ä—Ç—ã —Å–≤–æ–±–æ–¥–Ω—ã"

# 3. –ó–∞–ø—É—Å–∫–∞–µ–º –º–∞—Å—Ç–µ—Ä –°–ù–ê–ß–ê–õ–ê –æ–¥–∏–Ω
echo "=== –ó–∞–ø—É—Å–∫–∞–µ–º –º–∞—Å—Ç–µ—Ä (30 —Å–µ–∫—É–Ω–¥) ==="
docker-compose up -d yb-master
sleep 30

# 4. –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –º–∞—Å—Ç–µ—Ä –∑–∞–ø—É—Å—Ç–∏–ª—Å—è
docker-compose logs yb-master --tail 5
docker exec yugabyte-prod_yb-master_1 yb-admin --master_addresses yb-master:7100 list_all_masters

# 5. –ó–∞–ø—É—Å–∫–∞–µ–º –í–°–ï TServer –û–î–ù–û–í–†–ï–ú–ï–ù–ù–û
echo "=== –ó–∞–ø—É—Å–∫–∞–µ–º –≤—Å–µ 3 TServer (2 –º–∏–Ω—É—Ç—ã –æ–∂–∏–¥–∞–Ω–∏—è) ==="
docker-compose up -d
echo "–ñ–¥–µ–º –ø–æ–ª–Ω–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏... –≠—Ç–æ –∑–∞–π–º–µ—Ç 2-3 –º–∏–Ω—É—Ç—ã"
sleep 150  # –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –∂–¥–µ–º!

# 6. –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ —É–∑–ª—ã
docker-compose ps
```

### ‚úÖ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ —Ç–µ—Å—Ç–∞–º–∏

```bash
# 1. –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤—Å–µ TServer –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª–∏—Å—å
docker exec yugabyte-prod_yb-master_1 yb-admin --master_addresses yb-master:7100 list_all_tablet_servers

# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å 3 TServer –≤ —Å—Ç–∞—Ç—É—Å–µ ALIVE

# 2. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã
docker exec yugabyte-prod_yb-master_1 yb-admin --master_addresses yb-master:7100 list_tables | grep -i trans

# 3. –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—É—é —Ç–∞–±–ª–∏—Ü—É —á–µ—Ä–µ–∑ –õ–Æ–ë–û–ô –ø–æ—Ä—Ç
psql -h localhost -p 5433 -U yugabyte -c "
CREATE TABLE cluster_test (
    id SERIAL PRIMARY KEY,
    node_name TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

INSERT INTO cluster_test (node_name) VALUES 
    ('Node A - –ø–æ—Ä—Ç 5433'),
    ('Node B - –ø–æ—Ä—Ç 5434'), 
    ('Node C - –ø–æ—Ä—Ç 5435');

SELECT '–ö–ª–∞—Å—Ç–µ—Ä –∑–∞–ø—É—â–µ–Ω!' as status, COUNT(*) as rows FROM cluster_test;
"
```

### üß™ –¢–µ—Å—Ç –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ (–ü–†–ê–í–ò–õ–¨–ù–´–ô)

```bash
# –¢–µ—Å—Ç 1: –ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è —á–µ—Ä–µ–∑ —Ä–∞–∑–Ω—ã–µ –ø–æ—Ä—Ç—ã
echo "=== –¢–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π ==="
psql -h localhost -p 5433 -U yugabyte -c "SELECT '–ß–µ—Ä–µ–∑ –ø–æ—Ä—Ç 5433' as connection, * FROM cluster_test LIMIT 1;"
psql -h localhost -p 5434 -U yugabyte -c "SELECT '–ß–µ—Ä–µ–∑ –ø–æ—Ä—Ç 5434' as connection, * FROM cluster_test LIMIT 1;"
psql -h localhost -p 5435 -U yugabyte -c "SELECT '–ß–µ—Ä–µ–∑ –ø–æ—Ä—Ç 5435' as connection, * FROM cluster_test LIMIT 1;"

# –¢–µ—Å—Ç 2: –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–¥–∏–Ω TServer (–ù–ï –æ—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ä—Ç 5433)
echo "=== –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º yb-tserver-b (–ø–æ—Ä—Ç 5434) ==="
docker-compose stop yb-tserver-b
sleep 10

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —á–µ—Ä–µ–∑ –æ—Å—Ç–∞–≤—à–∏–µ—Å—è –ø–æ—Ä—Ç—ã
psql -h localhost -p 5433 -U yugabyte -c "SELECT '–ü–æ—Å–ª–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ 5434, —Ä–∞–±–æ—Ç–∞—é —á–µ—Ä–µ–∑ 5433' as status, COUNT(*) as rows FROM cluster_test;"
psql -h localhost -p 5435 -U yugabyte -c "SELECT '–ü–æ—Å–ª–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ 5434, —Ä–∞–±–æ—Ç–∞—é —á–µ—Ä–µ–∑ 5435' as status, COUNT(*) as rows FROM cluster_test;" || echo "–ü–æ—Ä—Ç 5435 –º–æ–∂–µ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞—Ç—å"

# –¢–µ—Å—Ç 3: –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Ç–æ—Ä–æ–π TServer (–æ—Å—Ç–∞–≤–ª—è–µ–º 1 –∏–∑ 3)
echo "=== –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º yb-tserver-c (–ø–æ—Ä—Ç 5435) ==="
docker-compose stop yb-tserver-c
sleep 10

# –¢–µ–ø–µ—Ä—å –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –¢–û–õ–¨–ö–û –ø–æ—Ä—Ç 5433
psql -h localhost -p 5433 -U yugabyte -c "SELECT '–û—Å—Ç–∞–ª—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Ä—Ç 5433' as status, COUNT(*) as rows FROM cluster_test;"

# –¢–µ—Å—Ç 4: –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Å–µ
echo "=== –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Å–µ —É–∑–ª—ã ==="
docker-compose start yb-tserver-b yb-tserver-c
sleep 30
psql -h localhost -p 5433 -U yugabyte -c "SELECT '–í—Å–µ —É–∑–ª—ã –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã' as status;"
```

### üîç –ï—Å–ª–∏ –≤—Å–µ –µ—â–µ –ø—Ä–æ–±–ª–µ–º—ã: –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

```bash
# 1. –°–º–æ—Ç—Ä–∏–º –ª–æ–≥–∏ –≤—Å–µ—Ö —É–∑–ª–æ–≤
docker-compose logs --tail 20

# 2. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∞–±–ª–µ—Ç–æ–≤
echo "=== –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∞–±–ª–µ—Ç–æ–≤ ==="
docker exec yugabyte-prod_yb-master_1 yb-admin --master_addresses yb-master:7100 list_tablets | head -20

# 3. –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–≤–æ—Ä—É–º
echo "=== –°–æ—Å—Ç–æ—è–Ω–∏–µ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ ==="
docker exec yugabyte-prod_yb-tserver-a_1 yb-admin --master_addresses yb-master:7100 list_all_tablet_servers

# 4. –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
echo "–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å: http://$(hostname -I | awk '{print $1}'):7000"
```

### üí° –ö–ª—é—á–µ–≤—ã–µ –æ—Ç–ª–∏—á–∏—è –Ω–æ–≤–æ–≥–æ –∫–æ–Ω—Ñ–∏–≥–∞:

1. **–í—Å–µ TServer –∏–º–µ—é—Ç —Ä–∞–∑–Ω—ã–µ –≤–Ω–µ—à–Ω–∏–µ –ø–æ—Ä—Ç—ã** (5433, 5434, 5435)
2. **RF=3 —è–≤–Ω–æ —É–∫–∞–∑–∞–Ω–æ –≤ –º–∞—Å—Ç–µ—Ä–µ**
3. **–ó–∞–ø—É—Å–∫ –º–∞—Å—Ç–µ—Ä–∞ –æ—Ç–¥–µ–ª—å–Ω–æ** –ø–µ—Ä–µ–¥ TServer
4. **–î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–µ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è** (2.5 –º–∏–Ω—É—Ç—ã)
5. **–ù–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞ –∏–º–µ–Ω** —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏

**–ó–∞–ø—É—Å—Ç–∏—Ç–µ —ç—Ç–æ—Ç –Ω–æ–≤—ã–π –∫–æ–Ω—Ñ–∏–≥ –≤ —á–∏—Å—Ç–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `~/yugabyte-prod` –∏ –ø–æ–∫–∞–∂–∏—Ç–µ –≤—ã–≤–æ–¥ –∫–æ–º–∞–Ω–¥—ã:**
```bash
docker exec yugabyte-prod_yb-master_1 yb-admin --master_addresses yb-master:7100 list_all_tablet_servers
```

–≠—Ç–æ –ø–æ–∫–∞–∂–µ—Ç, —Å–∫–æ–ª—å–∫–æ TServer —Ä–µ–∞–ª—å–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª–æ—Å—å –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ.
