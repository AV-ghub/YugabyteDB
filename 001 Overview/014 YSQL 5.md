–ü–æ–Ω—è–ª! –í –≤–∞—à–µ–π –≤–µ—Ä—Å–∏–∏ YugabyteDB **–Ω–µ—Ç –∫–æ–º–∞–Ω–¥—ã `delete_ysql_catalog`** (–æ–Ω–∞ –ø–æ—è–≤–∏–ª–∞—Å—å –≤ –±–æ–ª–µ–µ –Ω–æ–≤—ã—Ö –≤–µ—Ä—Å–∏—è—Ö). –î–∞–≤–∞–π—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥—Ä—É–≥–æ–π –ø–æ–¥—Ö–æ–¥ ‚Äî **–ø–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º docker-compose.yml**.

### üîß –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ: –ø–æ–ª–Ω—ã–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π

```bash
# 1. –ü–æ–ª–Ω–æ—Å—Ç—å—é –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏ –æ—á–∏—â–∞–µ–º –í–°–ï
docker-compose down -v
docker ps -aq --filter "name=yugabyte" | xargs -r docker rm -f
docker volume prune -f

# 2. –°–æ–∑–¥–∞–µ–º –ü–†–ê–í–ò–õ–¨–ù–´–ô docker-compose.yml
cat > docker-compose.yml << 'EOF'
version: '3.8'

services:
  yb-master-n1:
    image: yugabytedb/yugabyte:latest
    command:
      - "/home/yugabyte/bin/yb-master"
      - "--fs_data_dirs=/mnt/master"
      - "--master_addresses=yb-master-n1:7100,yb-master-n2:7100,yb-master-n3:7100"
      - "--rpc_bind_addresses=yb-master-n1:7100"
    mem_limit: 1024m
    ports:
      - "7000:7000"

  yb-master-n2:
    image: yugabytedb/yugabyte:latest
    command:
      - "/home/yugabyte/bin/yb-master"
      - "--fs_data_dirs=/mnt/master"
      - "--master_addresses=yb-master-n1:7100,yb-master-n2:7100,yb-master-n3:7100"
      - "--rpc_bind_addresses=yb-master-n2:7100"
    mem_limit: 1024m

  yb-master-n3:
    image: yugabytedb/yugabyte:latest
    command:
      - "/home/yugabyte/bin/yb-master"
      - "--fs_data_dirs=/mnt/master"
      - "--master_addresses=yb-master-n1:7100,yb-master-n2:7100,yb-master-n3:7100"
      - "--rpc_bind_addresses=yb-master-n3:7100"
    mem_limit: 1024m

  yb-tserver-n1:
    image: yugabytedb/yugabyte:latest
    command:
      - "/home/yugabyte/bin/yb-tserver"
      - "--fs_data_dirs=/mnt/tserver"
      - "--tserver_master_addrs=yb-master-n1:7100,yb-master-n2:7100,yb-master-n3:7100"
      - "--rpc_bind_addresses=yb-tserver-n1:9100"
      - "--enable_ysql"
      - "--ysql_enable_auth=false"
      - "--pgsql_proxy_bind_address=0.0.0.0:5433"
    ports:
      - "5433:5433"
    depends_on:
      yb-master-n1:
        condition: service_started
      yb-master-n2:
        condition: service_started  
      yb-master-n3:
        condition: service_started
    mem_limit: 2048m
EOF

# 3. –ó–∞–ø—É—Å–∫–∞–µ–º
docker-compose up -d

# 4. –ñ–¥–µ–º 3 –ú–ò–ù–£–¢–´ –¥–ª—è –ø–æ–ª–Ω–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
echo "–ñ–¥–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞ (—ç—Ç–æ –∑–∞–π–º–µ—Ç 3 –º–∏–Ω—É—Ç—ã)..."
sleep 180

# 5. –ü—Ä–æ–≤–µ—Ä—è–µ–º –ª–æ–≥–∏ –º–∞—Å—Ç–µ—Ä–æ–≤
echo "=== –ü—Ä–æ–≤–µ—Ä—è–µ–º –ª–æ–≥–∏ –º–∞—Å—Ç–µ—Ä–æ–≤ ==="
docker-compose logs yb-master-n1 | grep -i "leader\|election" | tail -5

# 6. –ü—Ä–æ–≤–µ—Ä—è–µ–º –ª–æ–≥–∏ TServer
echo "=== –ü—Ä–æ–≤–µ—Ä—è–µ–º –ª–æ–≥–∏ TServer ==="
docker-compose logs yb-tserver-n1 | grep -i "ysql\|postgres\|5433" | tail -10

# 7. –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
echo "=== –ü—Ä–æ–±—É–µ–º –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è ==="
psql -h localhost -p 5433 -U yugabyte -c "SELECT version();" 2>&1
```

### üìä –ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –Ω–æ–≤–æ–º –∫–æ–Ω—Ñ–∏–≥–µ:

1. **`--enable_ysql` –±–µ–∑ `=true`** ‚Äî –∏–Ω–æ–≥–¥–∞ —Ñ–ª–∞–≥ –±–µ–∑ –∑–Ω–∞—á–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –ª—É—á—à–µ
2. **`--pgsql_proxy_bind_address=0.0.0.0:5433`** ‚Äî —è–≤–Ω–æ–µ —É–∫–∞–∑–∞–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ –¥–ª—è YSQL
3. **`condition: service_started`** ‚Äî TServer –∂–¥–µ—Ç –∑–∞–ø—É—Å–∫–∞ –º–∞—Å—Ç–µ—Ä–æ–≤
4. **–ü–æ—Ä—Ç 7000 —Ç–æ–ª—å–∫–æ –Ω–∞ –ø–µ—Ä–≤–æ–º –º–∞—Å—Ç–µ—Ä–µ** ‚Äî —É–ø—Ä–æ—â–µ–Ω–∏–µ
5. **–£–±—Ä–∞–Ω—ã –ª–∏—à–Ω–∏–µ —Ñ–ª–∞–≥–∏** (`--server_broadcast_addresses`, `--ysql_num_shards_per_tserver`)

### üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –∑–∞–ø—Ä–æ—Å–æ–≤

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —ç—Ç–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏:

```bash
# 1. –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç
docker-compose ps

# 2. –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å–ª—É—à–∞–µ—Ç –ª–∏ –ø–æ—Ä—Ç 5433
docker exec yugabyte-yb-tserver-n1-1 netstat -tlnp | grep 5433

# 3. –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–æ—Ü–µ—Å—Å Postgres –≤–Ω—É—Ç—Ä–∏ TServer
docker exec yugabyte-yb-tserver-n1-1 ps aux | grep postgres

# 4. –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü YSQL
docker exec yugabyte-yb-tserver-n1-1 find /mnt/tserver -name "pg_*" -type d 2>/dev/null | head -5
```

### üéØ –ï—Å–ª–∏ –≤—Å–µ –µ—â–µ –æ—à–∏–±–∫–∞ `system.transactions`

–í—ã–ø–æ–ª–Ω–∏—Ç–µ —Ä—É—á–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –∫–∞—Ç–∞–ª–æ–≥–∞:

```bash
# –í—Ö–æ–¥–∏–º –≤ TServer
docker exec -it yugabyte-yb-tserver-n1-1 bash

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞—Ç–∞–ª–æ–≥ YSQL
ls -la /mnt/tserver/pg_data/

# –°–º–æ—Ç—Ä–∏–º –ª–æ–≥–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
cat /mnt/tserver/yb-data/tserver/logs/postgresql-*.log 2>/dev/null | grep -i "init\|catalog\|starting" | tail -20
```

### ‚è±Ô∏è –û–∂–∏–¥–∞–Ω–∏–µ ‚Äî —ç—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ

**–°–∞–º–∞—è —á–∞—Å—Ç–∞—è –ø—Ä–∏—á–∏–Ω–∞ –ø—Ä–æ–±–ª–µ–º—ã ‚Äî –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–µ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è.** –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –∫–ª–∞—Å—Ç–µ—Ä –∏–∑ 4 —É–∑–ª–æ–≤ —Ç—Ä–µ–±—É–µ—Ç –≤—Ä–µ–º–µ–Ω–∏:
- 30-60 —Å–µ–∫—É–Ω–¥: –≤—ã–±–æ—Ä –ª–∏–¥–µ—Ä–∞ –º–∞—Å—Ç–µ—Ä–æ–≤
- 30-60 —Å–µ–∫—É–Ω–¥: –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è YSQL –≤ TServer
- –ò—Ç–æ–≥–æ: **–º–∏–Ω–∏–º—É–º 2-3 –º–∏–Ω—É—Ç—ã** –ø–µ—Ä–µ–¥ –ø–µ—Ä–≤—ã–º –∑–∞–ø—Ä–æ—Å–æ–º

**–ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–º–∞–Ω–¥—ã –≤—ã—à–µ –∏ –ø–æ–∫–∞–∂–∏—Ç–µ –ø–æ–ª–Ω—ã–π –≤—ã–≤–æ–¥, –æ—Å–æ–±–µ–Ω–Ω–æ —à–∞–≥–æ–≤ 5, 6 –∏ 7.** –≠—Ç–æ –ø–æ–º–æ–∂–µ—Ç —Ç–æ—á–Ω–æ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å, –Ω–∞ –∫–∞–∫–æ–º —ç—Ç–∞–ø–µ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º–∞.
