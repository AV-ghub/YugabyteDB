–û—Ç–ª–∏—á–Ω–æ! –ù–∞—á–Ω–µ–º —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –ø–ª–∞–Ω–∞. –°–µ–≥–æ–¥–Ω—è **–î–µ–Ω—å 1: PostgreSQL vs –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è PostgreSQL**.

### üéØ –°–µ–≥–æ–¥–Ω—è—à–Ω—è—è —Ü–µ–ª—å
–ü–æ–Ω–∏–º–∞—Ç—å —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—É—é —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É:
- **–û–¥–∏–Ω–æ—á–Ω—ã–º PostgreSQL** (–≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ)
- **–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º YugabyteDB** (–≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ)

### üìä –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ: –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ç–µ—Å—Ç

#### –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ –≤–∞—à–µ–º –∫–ª–∞—Å—Ç–µ—Ä–µ

```sql
-- 1. –°–æ–∑–¥–∞–π—Ç–µ —Ç–∞–±–ª–∏—Ü—É —Å 1 –º–∏–ª–ª–∏–æ–Ω–æ–º –∑–∞–ø–∏—Å–µ–π
CREATE TABLE perf_test_single (
    id BIGSERIAL PRIMARY KEY,
    data TEXT,
    category INT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- 2. –ù–∞–ø–æ–ª–Ω–∏—Ç–µ –¥–∞–Ω–Ω—ã–º–∏ (—ç—Ç–æ –∑–∞–π–º–µ—Ç 1-2 –º–∏–Ω—É—Ç—ã)
INSERT INTO perf_test_single (data, category)
SELECT 
    md5(random()::text),
    floor(random() * 100)::int
FROM generate_series(1, 1000000);

-- 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑–º–µ—Ä —Ç–∞–±–ª–∏—Ü—ã
SELECT 
    pg_size_pretty(pg_total_relation_size('perf_test_single')) as total_size,
    COUNT(*) as row_count
FROM perf_test_single;
```

#### –®–∞–≥ 2: –ê–Ω–∞–ª–∏–∑ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ YugabyteDB

```sql
-- 1. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ, –∫–∞–∫ —Ç–∞–±–ª–∏—Ü–∞ —Ä–∞–∑–±–∏—Ç–∞ –Ω–∞ —Ç–∞–±–ª–µ—Ç—ã
-- –í psql –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
\dt+ perf_test_single

-- 2. –ò–ª–∏ —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è:
SELECT 
    t.table_name,
    count(*) as tablet_count,
    pg_size_pretty(sum(pg_table_size(format('%I.%I', table_schema, table_name)))) as total_size
FROM yb_table_properties('perf_test_single') t
GROUP BY t.table_name;
```

#### –®–∞–≥ 3: –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏

–û—Ç–∫—Ä–æ–π—Ç–µ `http://localhost:7000` –∏:
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Tables** ‚Üí –Ω–∞–π–¥–∏—Ç–µ `perf_test_single`
2. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ —Ç–∞–±–ª–∏—Ü—É ‚Üí –≤–∫–ª–∞–¥–∫–∞ **Tablets**
3. **–°–∫–æ–ª—å–∫–æ —Ç–∞–±–ª–µ—Ç–æ–≤ —Å–æ–∑–¥–∞–ª–æ—Å—å?**
4. **–ö–∞–∫ –æ–Ω–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –ø–æ TServer —É–∑–ª–∞–º?**

#### –®–∞–≥ 4: –¢–µ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

```sql
-- –¢–µ—Å—Ç 1: –¢–æ—á–µ—á–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ –ø–µ—Ä–≤–∏—á–Ω–æ–º—É –∫–ª—é—á—É (–æ–∂–∏–¥–∞–µ—Ç—Å—è –±—ã—Å—Ç—Ä—ã–π)
EXPLAIN (ANALYZE, BUFFERS) 
SELECT * FROM perf_test_single WHERE id = 500000;

-- –¢–µ—Å—Ç 2: –î–∏–∞–ø–∞–∑–æ–Ω–Ω—ã–π –ø–æ–∏—Å–∫ (range scan)
EXPLAIN (ANALYZE, BUFFERS)
SELECT * FROM perf_test_single 
WHERE id BETWEEN 400000 AND 400100;

-- –¢–µ—Å—Ç 3: –ê–≥—Ä–µ–≥–∞—Ü–∏—è —Å GROUP BY
EXPLAIN (ANALYZE, BUFFERS)
SELECT category, COUNT(*) 
FROM perf_test_single 
GROUP BY category 
ORDER BY COUNT(*) DESC 
LIMIT 10;

-- –¢–µ—Å—Ç 4: JOIN (–µ—Å–ª–∏ –µ—Å—Ç—å –≤—Ç–æ—Ä–∞—è —Ç–∞–±–ª–∏—Ü–∞)
CREATE TABLE categories AS
SELECT generate_series(0, 99) as id, 
       'Category ' || generate_series(0, 99) as name;

EXPLAIN (ANALYZE, BUFFERS)
SELECT c.name, COUNT(p.id) as item_count
FROM perf_test_single p
JOIN categories c ON p.category = c.id
GROUP BY c.name
ORDER BY item_count DESC
LIMIT 5;
```

### üîç –ö–ª—é—á–µ–≤—ã–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è

**–í –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ –æ–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞:**

1. **–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∞–±–ª–µ—Ç–æ–≤:**
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —à–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –¥–∏–∞–ø–∞–∑–æ–Ω—É –ø–µ—Ä–≤–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞
   - –†–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —É–∑–ª–∞–º

2. **–ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:**
   - Latency –æ–ø–µ—Ä–∞—Ü–∏–π –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —É–∑–ª–∞—Ö
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–ø–µ—Ä–∞—Ü–∏–π —á—Ç–µ–Ω–∏—è/–∑–∞–ø–∏—Å–∏

### üìà –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –≤—ã–≤–æ–¥—ã

| –ê—Å–ø–µ–∫—Ç | PostgreSQL Single-node | YugabyteDB Distributed | –ß—Ç–æ —ç—Ç–æ –∑–Ω–∞—á–∏—Ç |
|--------|-----------------------|------------------------|----------------|
| **–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ** | Vertical (–±–æ–ª—å—à–µ CPU/RAM) | **Horizontal** (–±–æ–ª—å—à–µ —É–∑–ª–æ–≤) | –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å —É–∑–ª—ã –ø–æ –º–µ—Ä–µ —Ä–æ—Å—Ç–∞ |
| **–î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö** | Single point of failure | **–†–µplicated (RF=3)** | –í—ã–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø–∞–¥–µ–Ω–∏–µ 2 –∏–∑ 3 —É–∑–ª–æ–≤ |
| **Consistency** | Strong (–≤ —Ä–∞–º–∫–∞—Ö —É–∑–ª–∞) | **Global strong** | –ì–∞—Ä–∞–Ω—Ç–∏–∏ ACID –¥–∞–∂–µ –º–µ–∂–¥—É —Ä–µ–≥–∏–æ–Ω–∞–º–∏ |
| **–õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö** | –í—Å–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞ –æ–¥–Ω–æ–º —É–∑–ª–µ | **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ** | –î–∞–Ω–Ω—ã–µ —Ä—è–¥–æ–º —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º |

### üí° –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç "–ß—Ç–æ –µ—Å–ª–∏..."

```bash
# 1. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –æ–¥–∏–Ω TServer –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
docker compose stop yb-tserver2

# 2. –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å –∑–∞–ø—Ä–æ—Å—ã - –æ–Ω–∏ –¥–æ–ª–∂–Ω—ã —Ä–∞–±–æ—Ç–∞—Ç—å!
psql -h localhost -p 5433 -U yugabyte -c "SELECT COUNT(*) FROM perf_test_single;"

# 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ:
# - –ö–∞–∫ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∞–±–ª–µ—Ç–æ–≤?
# - –ö–∞–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å?
```

### üìù –î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

1. **–°–æ–∑–¥–∞–π—Ç–µ —Ç–∞–±–ª–∏—Ü—É —Å hash-—à–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏–µ–º:**
   ```sql
   CREATE TABLE perf_test_hash (
       id BIGSERIAL,
       data TEXT,
       PRIMARY KEY(id HASH)
   ) SPLIT INTO 16 TABLETS;
   ```

2. **–°—Ä–∞–≤–Ω–∏—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** range vs hash sharding

### ‚ùì –í–æ–ø—Ä–æ—Å—ã –¥–ª—è —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏—è

1. –ö–∞–∫ YugabyteDB –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å PostgreSQL, –±—É–¥—É—á–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π –ë–î?
2. –ö–∞–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –±—É–¥—É—Ç –±—ã—Å—Ç—Ä–µ–µ –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π —Å—Ä–µ–¥–µ, –∞ –∫–∞–∫–∏–µ –º–µ–¥–ª–µ–Ω–Ω–µ–µ?
3. –ö–∞–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤–ª–∏—è–µ—Ç –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏ —Å–±–æ—è—Ö?

### üöÄ –ß—Ç–æ –¥–∞–ª—å—à–µ?

**–ó–∞–≤—Ç—Ä–∞ (–î–µ–Ω—å 2):** –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Å–ª–æ–∏: YSQL API, DocDB, RAFT  
–ú—ã —Ä–∞–∑–±–µ—Ä–µ–º, –∫–∞–∫ –∑–∞–ø—Ä–æ—Å `SELECT * FROM table` –ø—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ –≤—Å–µ —Å–ª–æ–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã.

**–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —à–∞–≥–∏ –∏ –æ—Ç–≤–µ—Ç—å—Ç–µ:**
1. –°–∫–æ–ª—å–∫–æ —Ç–∞–±–ª–µ—Ç–æ–≤ —Å–æ–∑–¥–∞–ª–æ—Å—å –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã `perf_test_single`?
2. –ö–∞–∫ –æ–Ω–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏–ª–∏—Å—å –ø–æ TServer —É–∑–ª–∞–º?
3. –ö–∞–∫–æ–π –∏–∑ —Ç–µ—Å—Ç–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –≤—ã–ø–æ–ª–Ω–∏–ª—Å—è –±—ã—Å—Ç—Ä–µ–µ/–º–µ–¥–ª–µ–Ω–Ω–µ–µ, —á–µ–º –≤—ã –æ–∂–∏–¥–∞–ª–∏?

–≠—Ç–æ –¥–∞—Å—Ç –Ω–∞–º –æ—Å–Ω–æ–≤—É –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã.
